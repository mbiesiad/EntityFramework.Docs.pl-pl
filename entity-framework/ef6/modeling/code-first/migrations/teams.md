---
title: Migracje Code First na środowiska zespołowe - EF6
author: divega
ms.date: 10/23/2016
ms.assetid: 4c2d9a95-de6f-4e97-9738-c1f8043eff69
ms.openlocfilehash: 53460b6cdd454099ccf93b4e2133e4ea21278a64
ms.sourcegitcommit: fa863883f1193d2118c2f9cee90808baa5e3e73e
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 12/04/2018
ms.locfileid: "52857471"
---
# <a name="code-first-migrations-in-team-environments"></a><span data-ttu-id="1c496-102">Migracje Code First na środowiska zespołowe</span><span class="sxs-lookup"><span data-stu-id="1c496-102">Code First Migrations in Team Environments</span></span>
> [!NOTE]
> <span data-ttu-id="1c496-103">W tym artykule przyjęto założenie, że wiesz, jak użyć migracje Code First w podstawowych scenariuszy.</span><span class="sxs-lookup"><span data-stu-id="1c496-103">This article assumes you know how to use Code First Migrations in basic scenarios.</span></span> <span data-ttu-id="1c496-104">Jeśli tego nie zrobisz, a następnie należy odczytać [migracje Code First](~/ef6/modeling/code-first/migrations/index.md) przed kontynuowaniem.</span><span class="sxs-lookup"><span data-stu-id="1c496-104">If you don’t, then you’ll need to read [Code First Migrations](~/ef6/modeling/code-first/migrations/index.md) before continuing.</span></span>

## <a name="grab-a-coffee-you-need-to-read-this-whole-article"></a><span data-ttu-id="1c496-105">Pobierz kawy, musisz przeczytaj ten artykuł, całe</span><span class="sxs-lookup"><span data-stu-id="1c496-105">Grab a coffee, you need to read this whole article</span></span>

<span data-ttu-id="1c496-106">Problemów w środowiskach zespołu są głównie wokół scalanie migracji po dwóch programistów wygenerowały migracji w swoich lokalnych kod podstawowy.</span><span class="sxs-lookup"><span data-stu-id="1c496-106">The issues in team environments are mostly around merging migrations when two developers have generated migrations in their local code base.</span></span> <span data-ttu-id="1c496-107">Kroki, aby rozwiązać te są całkiem proste, wymagają one może być pełny opis sposobu działania migracji.</span><span class="sxs-lookup"><span data-stu-id="1c496-107">While the steps to solve these are pretty simple, they require you to have a solid understanding of how migrations works.</span></span> <span data-ttu-id="1c496-108">Proszę nie po prostu przejść od razu na końcu — Poświęć chwilę Aby odczytać cały artykuł, aby upewnić się, że możesz pomyślnie.</span><span class="sxs-lookup"><span data-stu-id="1c496-108">Please don’t just skip ahead to the end – take the time to read the whole article to ensure you are successful.</span></span>

## <a name="some-general-guidelines"></a><span data-ttu-id="1c496-109">Ogólne wskazówki</span><span class="sxs-lookup"><span data-stu-id="1c496-109">Some general guidelines</span></span>

<span data-ttu-id="1c496-110">Przed rozpoczęciem omawiania jak zarządzać scalania migracje generowane przez wielu deweloperów, poniżej przedstawiono ogólne wskazówki, które ukierunkowane na powodzenie.</span><span class="sxs-lookup"><span data-stu-id="1c496-110">Before we dig into how to manage merging migrations generated by multiple developers, here are some general guidelines to set you up for success.</span></span>

### <a name="each-team-member-should-have-a-local-development-database"></a><span data-ttu-id="1c496-111">Każdy członek zespołu powinien mieć lokalny rozwój bazy danych</span><span class="sxs-lookup"><span data-stu-id="1c496-111">Each team member should have a local development database</span></span>

<span data-ttu-id="1c496-112">Zastosowań migracje  **\_ \_MigrationsHistory** tabelę do przechowywania, jakie migracji zostały zastosowane do bazy danych.</span><span class="sxs-lookup"><span data-stu-id="1c496-112">Migrations uses the **\_\_MigrationsHistory** table to store what migrations have been applied to the database.</span></span> <span data-ttu-id="1c496-113">Jeśli masz wielu deweloperów generowania różne migracje podczas próby pod kątem tej samej bazy danych (i udostępnianie w ten sposób  **\_ \_MigrationsHistory** tabeli) migracje zamierza uzyskać bardzo mylące.</span><span class="sxs-lookup"><span data-stu-id="1c496-113">If you have multiple developers generating different migrations while trying to target the same database (and thus share a **\_\_MigrationsHistory** table) migrations is going to get very confused.</span></span>

<span data-ttu-id="1c496-114">Oczywiście w przypadku członków zespołu, którzy nie są Generowanie migracje występuje problem, nie pozwól, aby udostępnić bazę danych centralnej rozwoju.</span><span class="sxs-lookup"><span data-stu-id="1c496-114">Of course, if you have team members that aren’t generating migrations, there is no problem having them share a central development database.</span></span>

### <a name="avoid-automatic-migrations"></a><span data-ttu-id="1c496-115">Należy unikać automatycznej migracji</span><span class="sxs-lookup"><span data-stu-id="1c496-115">Avoid automatic migrations</span></span>

<span data-ttu-id="1c496-116">Mierzenie to, że automatycznej migracji początkowo wyglądają dobrze w środowiskach zespołu, ale w rzeczywistości po prostu nie działają.</span><span class="sxs-lookup"><span data-stu-id="1c496-116">The bottom line is that automatic migrations initially look good in team environments, but in reality they just don’t work.</span></span> <span data-ttu-id="1c496-117">Jeśli chcesz wiedzieć Dlaczego, Zachowaj czytania — Jeśli nie, następnie można przejść do następnej sekcji.</span><span class="sxs-lookup"><span data-stu-id="1c496-117">If you want to know why, keep reading – if not, then you can skip to the next section.</span></span>

<span data-ttu-id="1c496-118">Automatyczne migracji umożliwia zostały zaktualizowane w celu dopasowania bieżącego modelu bez konieczności generowanie kodu plików (migracje oparte na kodzie) schemat bazy danych.</span><span class="sxs-lookup"><span data-stu-id="1c496-118">Automatic migrations allows you to have your database schema updated to match the current model without the need to generate code files (code-based migrations).</span></span> <span data-ttu-id="1c496-119">Automatyczne migracje będzie bardzo dobrze pracować w środowisku zespołowym, jeśli tylko nigdy nie użył ich i nigdy nie generowane wszystkie migracje oparte na kodzie.</span><span class="sxs-lookup"><span data-stu-id="1c496-119">Automatic migrations would work very well in a team environment if you only ever used them and never generated any code-based migrations.</span></span> <span data-ttu-id="1c496-120">Problem polega na czy automatycznej migracji są ograniczone i nie obsługują wielu operacji — zmienia nazwę kolumny właściwości/przenoszenia danych do innej tabeli itp. Do obsługi tych scenariuszy, na końcu generowania migracje oparte na kod (i edytowania utworzony szkielet kodu), które są zmieszane Between zmiany, które są obsługiwane przez automatyczne migracji.</span><span class="sxs-lookup"><span data-stu-id="1c496-120">The problem is that automatic migrations are limited and don’t handle a number of operations – property/column renames, moving data to another table, etc. To handle these scenarios you end up generating code-based migrations (and editing the scaffolded code) that are mixed in between changes that are handled by automatic migrations.</span></span> <span data-ttu-id="1c496-121">Dzięki temu niemal na niemożliwe do scalania zmian, gdy dwa deweloperzy ewidencjonują migracji.</span><span class="sxs-lookup"><span data-stu-id="1c496-121">This makes it near on impossible to merge changes when two developers check in migrations.</span></span>

## <a name="screencasts"></a><span data-ttu-id="1c496-122">Zrzuty ekranu</span><span class="sxs-lookup"><span data-stu-id="1c496-122">Screencasts</span></span>

<span data-ttu-id="1c496-123">Jeśli zrzut ekranu niż przeczytaj ten artykuł będzie wolisz obejrzeć, następujące dwa filmy wideo obejmuje tę samą zawartość, jak w tym artykule.</span><span class="sxs-lookup"><span data-stu-id="1c496-123">If you'd rather watch a screencast than read this article, the following two videos cover the same content as this article.</span></span>

### <a name="video-one-migrations---under-the-hood"></a><span data-ttu-id="1c496-124">Wideo 1: "Migracje - Under the Hood"</span><span class="sxs-lookup"><span data-stu-id="1c496-124">Video One: "Migrations - Under the Hood"</span></span>

<span data-ttu-id="1c496-125">[Ten zrzut ekranu](http://channel9.msdn.com/blogs/ef/migrations-under-the-hood) opisano sposób migracji śledzi i używa informacji o modelu, aby wykrywać zmiany modelu.</span><span class="sxs-lookup"><span data-stu-id="1c496-125">[This screencast](http://channel9.msdn.com/blogs/ef/migrations-under-the-hood) covers how migrations tracks and uses information about the model to detect model changes.</span></span>

### <a name="video-two-migrations---team-environments"></a><span data-ttu-id="1c496-126">Dwa wideo: "Migracje - środowiska zespołowe"</span><span class="sxs-lookup"><span data-stu-id="1c496-126">Video Two: "Migrations - Team Environments"</span></span>

<span data-ttu-id="1c496-127">Opierając się na koncepcji z poprzednim filmu wideo, [ten zrzut ekranu](http://channel9.msdn.com/blogs/ef/migrations-team-environments) omówiono zagadnienia, które pojawiają się w środowisku zespołowym oraz sposoby ich rozwiązywania.</span><span class="sxs-lookup"><span data-stu-id="1c496-127">Building on the concepts from the previous video, [this screencast](http://channel9.msdn.com/blogs/ef/migrations-team-environments) covers the issues that arise in a team environment and how to solve them.</span></span>

## <a name="understanding-how-migrations-works"></a><span data-ttu-id="1c496-128">Zrozumienie sposobu działania migracji</span><span class="sxs-lookup"><span data-stu-id="1c496-128">Understanding how migrations works</span></span>

<span data-ttu-id="1c496-129">Klawisz, aby pomyślnie przy użyciu migracji w środowisku zespołowym, to podstawowy zrozumienie, jak migracje śledzi i używa informacji o modelu do wykrycia zmiany modelu.</span><span class="sxs-lookup"><span data-stu-id="1c496-129">The key to successfully using migrations in a team environment is a basic understanding how migrations tracks and uses information about the model to detect model changes.</span></span>

### <a name="the-first-migration"></a><span data-ttu-id="1c496-130">Pierwszej migracji</span><span class="sxs-lookup"><span data-stu-id="1c496-130">The first migration</span></span>

<span data-ttu-id="1c496-131">Po pierwszej migracji możesz dodać do projektu, możesz uruchomić podobny **migracji Dodaj pierwszy** w konsoli Menedżera pakietów.</span><span class="sxs-lookup"><span data-stu-id="1c496-131">When you add the first migration to your project, you run something like **Add-Migration First** in Package Manager Console.</span></span> <span data-ttu-id="1c496-132">Kroki wysokiego poziomu, które wykonuje to polecenie jest na ilustracji poniżej.</span><span class="sxs-lookup"><span data-stu-id="1c496-132">The high level steps that this command performs are pictured below.</span></span>

![Pierwszej migracji](~/ef6/media/firstmigration.png)

<span data-ttu-id="1c496-134">Bieżący model jest obliczana w kodzie (1).</span><span class="sxs-lookup"><span data-stu-id="1c496-134">The current model is calculated from your code (1).</span></span> <span data-ttu-id="1c496-135">Obiekty bazy danych wymagane jest następnie obliczana z użyciem różnią się modelu (2) — ponieważ jest to pierwszy migracji modelu różnią się jedynie używa pusty model do porównania.</span><span class="sxs-lookup"><span data-stu-id="1c496-135">The required database objects are then calculated by the model differ (2) – since this is the first migration the model differ just uses an empty model for the comparison.</span></span> <span data-ttu-id="1c496-136">Wymagane zmiany są przekazywane do generatora kodu, aby skompilować kod Wymagana migracja (3), która jest następnie dodawana do rozwiązania programu Visual Studio (4).</span><span class="sxs-lookup"><span data-stu-id="1c496-136">The required changes are passed to the code generator to build the required migration code (3) which is then added to your Visual Studio solution (4).</span></span>

<span data-ttu-id="1c496-137">Oprócz kodu rzeczywistą migrację, który jest przechowywany w pliku głównego kodu migracje generuje również niektórych dodatkowych plików z kodem.</span><span class="sxs-lookup"><span data-stu-id="1c496-137">In addition to the actual migration code that is stored in the main code file, migrations also generates some additional code-behind files.</span></span> <span data-ttu-id="1c496-138">Te pliki są metadane, który jest używany przez migracje i nie coś, co należy edytować.</span><span class="sxs-lookup"><span data-stu-id="1c496-138">These files are metadata that is used by migrations and are not something you should edit.</span></span> <span data-ttu-id="1c496-139">Jeden z tych plików jest plik zasobów (.resx) zawiera migawkę tego modelu w czasie migracji została wygenerowana.</span><span class="sxs-lookup"><span data-stu-id="1c496-139">One of these files is a resource file (.resx) that contains a snapshot of the model at the time the migration was generated.</span></span> <span data-ttu-id="1c496-140">Zobaczysz, jak jest on używany w następnym kroku.</span><span class="sxs-lookup"><span data-stu-id="1c496-140">You’ll see how this is used in the next step.</span></span>

<span data-ttu-id="1c496-141">W tym momencie należy prawdopodobnie uruchomić **Update-Database** Aby zastosować zmiany do bazy danych, a następnie przejdź dotyczących implementowania innych obszarów aplikacji.</span><span class="sxs-lookup"><span data-stu-id="1c496-141">At this point you would probably run **Update-Database** to apply your changes to the database, and then go about implementing other areas of your application.</span></span>

### <a name="subsequent-migrations"></a><span data-ttu-id="1c496-142">Kolejne migracje</span><span class="sxs-lookup"><span data-stu-id="1c496-142">Subsequent migrations</span></span>

<span data-ttu-id="1c496-143">Później możesz wrócić i wprowadzić pewne zmiany na modelu — w tym przykładzie dodamy **adresu Url** właściwości **blogu**.</span><span class="sxs-lookup"><span data-stu-id="1c496-143">Later you come back and make some changes to your model – in our example we’ll add a **Url** property to **Blog**.</span></span> <span data-ttu-id="1c496-144">Następnie może wydać polecenie takich jak **AddUrl migracji Dodaj** zmienia się do tworzenia szkieletu migracji, aby zastosować odpowiednie bazy danych.</span><span class="sxs-lookup"><span data-stu-id="1c496-144">You would then issue a command such as **Add-Migration AddUrl** to scaffold a migration to apply the corresponding database changes.</span></span> <span data-ttu-id="1c496-145">Kroki wysokiego poziomu, które wykonuje to polecenie jest na ilustracji poniżej.</span><span class="sxs-lookup"><span data-stu-id="1c496-145">The high level steps that this command performs are pictured below.</span></span>

![Drugi migracji](~/ef6/media/secondmigration.png)

<span data-ttu-id="1c496-147">Podobnie jak wcześniej bieżący model jest obliczana na podstawie kodu (1).</span><span class="sxs-lookup"><span data-stu-id="1c496-147">Just like last time, the current model is calculated from code (1).</span></span> <span data-ttu-id="1c496-148">Tym razem istnieją migracji istniejących więc w poprzednim modelu są pobierane z najnowszych migracji (2).</span><span class="sxs-lookup"><span data-stu-id="1c496-148">However, this time there are existing migrations so the previous model is retrieved from the latest migration (2).</span></span> <span data-ttu-id="1c496-149">Te dwa modele są diffed można znaleźć wymaganych zmian w bazie danych (3), a następnie proces kończy się tak jak poprzednio.</span><span class="sxs-lookup"><span data-stu-id="1c496-149">These two models are diffed to find the required database changes (3) and then the process completes as before.</span></span>

<span data-ttu-id="1c496-150">Ten sam proces jest używany dla dalszych migracji, które dodajesz do projektu.</span><span class="sxs-lookup"><span data-stu-id="1c496-150">This same process is used for any further migrations that you add to the project.</span></span>

### <a name="why-bother-with-the-model-snapshot"></a><span data-ttu-id="1c496-151">Dlaczego odblokowane z migawką modelu?</span><span class="sxs-lookup"><span data-stu-id="1c496-151">Why bother with the model snapshot?</span></span>

<span data-ttu-id="1c496-152">Możesz się zastanawiać, dlaczego EF bothers z migawką modelu — Dlaczego się nie tylko bazy danych.</span><span class="sxs-lookup"><span data-stu-id="1c496-152">You may be wondering why EF bothers with the model snapshot – why not just look at the database.</span></span> <span data-ttu-id="1c496-153">Jeśli tak, Czytaj dalej.</span><span class="sxs-lookup"><span data-stu-id="1c496-153">If so, read on.</span></span> <span data-ttu-id="1c496-154">Jeśli użytkownik nie chce można pominąć tę sekcję.</span><span class="sxs-lookup"><span data-stu-id="1c496-154">If you’re not interested then you can skip this section.</span></span>

<span data-ttu-id="1c496-155">Istnieje wiele możliwych przyczyn, które EF przechowuje migawki modelu wokół:</span><span class="sxs-lookup"><span data-stu-id="1c496-155">There are a number of reasons EF keeps the model snapshot around:</span></span>

-   <span data-ttu-id="1c496-156">Umożliwia ona bazy danych w celu odstają od modelu platformy EF.</span><span class="sxs-lookup"><span data-stu-id="1c496-156">It allows your database to drift from the EF model.</span></span> <span data-ttu-id="1c496-157">Tych zmian bezpośrednio w bazie danych lub utworzony szkielet kodu można zmienić w migracji w taki sposób, aby wprowadzić zmiany.</span><span class="sxs-lookup"><span data-stu-id="1c496-157">These changes can be made directly in the database, or you can change the scaffolded code in your migrations to make the changes.</span></span> <span data-ttu-id="1c496-158">Poniżej przedstawiono kilka przykładów tego w praktyce:</span><span class="sxs-lookup"><span data-stu-id="1c496-158">Here are a couple of examples of this in practice:</span></span>
    -   <span data-ttu-id="1c496-159">Aby dodać kolumnę do jednej lub kilku tabel wstawione i zaktualizowane, ale nie chcesz uwzględnić te kolumny w modelu platformy EF.</span><span class="sxs-lookup"><span data-stu-id="1c496-159">You want to add an Inserted and Updated to column to one or more of your tables but you don’t want to include these columns in the EF model.</span></span> <span data-ttu-id="1c496-160">Jeśli migracja przyjrzano się bazy danych stale może spróbować usunąć te kolumny, za każdym razem, gdy działanie migracji.</span><span class="sxs-lookup"><span data-stu-id="1c496-160">If migrations looked at the database it would continually try to drop these columns every time you scaffolded a migration.</span></span> <span data-ttu-id="1c496-161">Przy użyciu migawki modelu, EF tylko wykryje uzasadnione zmiany w modelu.</span><span class="sxs-lookup"><span data-stu-id="1c496-161">Using the model snapshot, EF will only ever detect legitimate changes to the model.</span></span>
    -   <span data-ttu-id="1c496-162">Chcesz zmienić treść funkcji procedurę składowaną, która jest używana w przypadku aktualizacji do uwzględnienia niektórych rejestrowania.</span><span class="sxs-lookup"><span data-stu-id="1c496-162">You want to change the body of a stored procedure used for updates to include some logging.</span></span> <span data-ttu-id="1c496-163">Jeśli migracji przyjrzano tę procedurę składowaną z bazy danych będzie stale spróbuj i przywrócić jego definicji, który oczekuje, że EF.</span><span class="sxs-lookup"><span data-stu-id="1c496-163">If migrations looked at this stored procedure from the database it would continually try and reset it back to the definition that EF expects.</span></span> <span data-ttu-id="1c496-164">Za pomocą migawki modelu, EF będzie tylko tworzenia szkieletu kodu lub zmieniać procedury składowanej w przypadku zmiany kształtu procedurę opisaną w modelu platformy EF.</span><span class="sxs-lookup"><span data-stu-id="1c496-164">By using the model snapshot, EF will only ever scaffold code to alter the stored procedure when you change the shape of the procedure in the EF model.</span></span>
    -   <span data-ttu-id="1c496-165">Te same zasady mają zastosowanie do dodawania dodatkowych indeksów, w tym dodatkowe tabele w bazie danych, mapowanie EF na widok bazy danych, który znajduje się za pośrednictwem tabeli itp.</span><span class="sxs-lookup"><span data-stu-id="1c496-165">These same principles apply to adding extra indexes, including extra tables in your database, mapping EF to a database view that sits over a table, etc.</span></span>
-   <span data-ttu-id="1c496-166">Modelu platformy EF zawiera więcej niż tylko kształt bazy danych.</span><span class="sxs-lookup"><span data-stu-id="1c496-166">The EF model contains more than just the shape of the database.</span></span> <span data-ttu-id="1c496-167">Posiadanie cały model umożliwia migracji wyświetlić informacje dotyczące właściwości i klasy w modelu oraz sposobu mapowania ich na kolumn i tabel.</span><span class="sxs-lookup"><span data-stu-id="1c496-167">Having the entire model allows migrations to look at information about the properties and classes in your model and how they map to the columns and tables.</span></span> <span data-ttu-id="1c496-168">Informacje te pozwalają migracje się bardziej inteligentne w kodzie, który go szkielety mechanizmów.</span><span class="sxs-lookup"><span data-stu-id="1c496-168">This information allows migrations to be more intelligent in the code that it scaffolds.</span></span> <span data-ttu-id="1c496-169">Na przykład jeśli zmienisz nazwę kolumny, która właściwość mapuje do migracji może wykrywać zmiany nazwy, zobaczysz, że jest tę samą właściwość — coś, co nie można przeprowadzić, jeśli masz tylko schemat bazy danych.</span><span class="sxs-lookup"><span data-stu-id="1c496-169">For example, if you change the name of the column that a property maps to migrations can detect the rename by seeing that it’s the same property – something that can’t be done if you only have the database schema.</span></span> 

## <a name="what-causes-issues-in-team-environments"></a><span data-ttu-id="1c496-170">Co powoduje, że problemy w środowiskach zespołu</span><span class="sxs-lookup"><span data-stu-id="1c496-170">What causes issues in team environments</span></span>

<span data-ttu-id="1c496-171">Przepływ pracy omówione w poprzednich działa sekcja doskonałe, podczas pracy nad aplikacją jednego dewelopera.</span><span class="sxs-lookup"><span data-stu-id="1c496-171">The workflow covered in the previous section works great when you are a single developer working on an application.</span></span> <span data-ttu-id="1c496-172">Działa dobrze w środowisku zespołowym, jeśli jesteś jedyną osobą, zmiany wprowadzone w modelu.</span><span class="sxs-lookup"><span data-stu-id="1c496-172">It also works well in a team environment if you are the only person making changes to the model.</span></span> <span data-ttu-id="1c496-173">W tym scenariuszu można wprowadzić zmiany w modelu, generowania migracje i przesyłanie ich do kontroli źródła.</span><span class="sxs-lookup"><span data-stu-id="1c496-173">In this scenario you can make model changes, generate migrations and submit them to your source control.</span></span> <span data-ttu-id="1c496-174">Inni deweloperzy mogą synchronizowanie zmian i uruchamiać **Update-Database** zastosować zmian schematu.</span><span class="sxs-lookup"><span data-stu-id="1c496-174">Other developers can sync your changes and run **Update-Database** to have the schema changes applied.</span></span>

<span data-ttu-id="1c496-175">Problemy z Rozpocznij wystąpić w przypadku wielu deweloperów wprowadzanie zmian modelu platformy EF i przesyłanie do kontroli źródła, w tym samym czasie.</span><span class="sxs-lookup"><span data-stu-id="1c496-175">Issues start to arise when you have multiple developers making changes to the EF model and submitting to source control at the same time.</span></span> <span data-ttu-id="1c496-176">Nie posiada EF jest najwyższej klasy można scalić migracji lokalnej za pomocą migracji, które innemu deweloperowi zostało przesłane do kontroli źródła, ponieważ Ostatnia synchronizacja.</span><span class="sxs-lookup"><span data-stu-id="1c496-176">What EF lacks is a first class way to merge your local migrations with migrations that another developer has submitted to source control since you last synced.</span></span>

## <a name="an-example-of-a-merge-conflict"></a><span data-ttu-id="1c496-177">Przykładem konfliktu scalania</span><span class="sxs-lookup"><span data-stu-id="1c496-177">An example of a merge conflict</span></span>

<span data-ttu-id="1c496-178">Pierwszy Przyjrzyjmy się konkretny przykład konfliktu scalania.</span><span class="sxs-lookup"><span data-stu-id="1c496-178">First let’s look at a concrete example of such a merge conflict.</span></span> <span data-ttu-id="1c496-179">Będziemy dalej na przykład, który przyjrzeliśmy się wcześniej.</span><span class="sxs-lookup"><span data-stu-id="1c496-179">We’ll continue on with the example we looked at earlier.</span></span> <span data-ttu-id="1c496-180">Jako początkowy punkt możemy założyć zmian z poprzedniej sekcji zostały zaewidencjonowane przez dewelopera, oryginalnym.</span><span class="sxs-lookup"><span data-stu-id="1c496-180">As a starting point let’s assume the changes from the previous section were checked in by the original developer.</span></span> <span data-ttu-id="1c496-181">Będziesz Śledzimy dwa deweloperom, jak oni wprowadzić zmiany do kodu podstawowego</span><span class="sxs-lookup"><span data-stu-id="1c496-181">We’ll track two developers as they make changes to code base.</span></span>

<span data-ttu-id="1c496-182">Firma Microsoft będzie śledzić modelu platformy EF migracjach do większej liczby zmian.</span><span class="sxs-lookup"><span data-stu-id="1c496-182">We’ll track the EF model and the migrations thru a number of changes.</span></span> <span data-ttu-id="1c496-183">Punkt początkowy zarówno deweloperów zsynchronizowanych repozytorium kontroli źródła, jak pokazano na poniższym rysunku.</span><span class="sxs-lookup"><span data-stu-id="1c496-183">For a starting point, both developers have synced to the source control repository, as depicted in the following graphic.</span></span>

![Punkt początkowy](~/ef6/media/startingpoint.png)

<span data-ttu-id="1c496-185">Deweloper \#1 i deweloperów \#2 teraz sprawia, że pewne zmiany do modelu platformy EF w swoich lokalnych kod podstawowy.</span><span class="sxs-lookup"><span data-stu-id="1c496-185">Developer \#1 and developer \#2 now makes some changes to the EF model in their local code base.</span></span> <span data-ttu-id="1c496-186">Deweloper \#dodaje 1 **ocena** właściwości **Blog** — i generuje **AddRating** migracji w celu zastosowania zmian w bazie danych.</span><span class="sxs-lookup"><span data-stu-id="1c496-186">Developer \#1 adds a **Rating** property to **Blog** – and generates an **AddRating** migration to apply the changes to the database.</span></span> <span data-ttu-id="1c496-187">Deweloper \#2 dodaje **czytelnicy** właściwości **Blog** — i generuje odpowiedni **AddReaders** migracji.</span><span class="sxs-lookup"><span data-stu-id="1c496-187">Developer \#2 adds a **Readers** property to **Blog** – and generates the corresponding **AddReaders** migration.</span></span> <span data-ttu-id="1c496-188">Uruchom zarówno deweloperów **Update-Database**, aby zastosować zmiany w swoich lokalnych baz danych, a następnie kontynuuj, tworzenia aplikacji.</span><span class="sxs-lookup"><span data-stu-id="1c496-188">Both developers run **Update-Database**, to apply the changes to their local databases, and then continue developing the application.</span></span>

> [!NOTE]
> <span data-ttu-id="1c496-189">Migracje mają prefiks sygnaturę czasową, dzięki czemu nasze grafika przedstawia, migracja AddReaders z deweloperów \#2 pochodzi po migracji AddRating Developer \#1.</span><span class="sxs-lookup"><span data-stu-id="1c496-189">Migrations are prefixed with a timestamp, so our graphic represents that the AddReaders migration from Developer \#2 comes after the AddRating migration from Developer \#1.</span></span> <span data-ttu-id="1c496-190">Czy dla deweloperów \#1 lub \#2 generowane migracji pierwszej sprawia, że nie ma wpływu problemów pracy w zespole lub procesu scalania ich, które omówimy w następnej sekcji.</span><span class="sxs-lookup"><span data-stu-id="1c496-190">Whether developer \#1 or \#2 generated the migration first makes no difference to the issues of working in a team, or the process for merging them that we’ll look at in the next section.</span></span>

![Lokalne zmiany](~/ef6/media/localchanges.png)

<span data-ttu-id="1c496-192">To dzień, szczęście Deweloper \#1 po ich wprowadzeniu przedstawią ich zmiany.</span><span class="sxs-lookup"><span data-stu-id="1c496-192">It’s a lucky day for Developer \#1 as they happen to submit their changes first.</span></span> <span data-ttu-id="1c496-193">Ponieważ żaden inny użytkownik zaewidencjonował ponieważ one zsynchronizowane z własnym repozytorium, ich zmiany może przesłać tylko bez przeprowadzania żadnych scalania.</span><span class="sxs-lookup"><span data-stu-id="1c496-193">Because no one else has checked in since they synced their repository, they can just submit their changes without performing any merging.</span></span>

![Prześlij](~/ef6/media/submit.png)

<span data-ttu-id="1c496-195">Teraz nadszedł czas na dewelopera \#2, aby przesłać.</span><span class="sxs-lookup"><span data-stu-id="1c496-195">Now it’s time for Developer \#2 to submit.</span></span> <span data-ttu-id="1c496-196">Nie są one takie szczęście.</span><span class="sxs-lookup"><span data-stu-id="1c496-196">They aren’t so lucky.</span></span> <span data-ttu-id="1c496-197">Ponieważ ktoś inny zostało przesłane zmiany, ponieważ są synchronizowane, należy ściągnąć zmiany i scalania.</span><span class="sxs-lookup"><span data-stu-id="1c496-197">Because someone else has submitted changes since they synced, they will need to pull down the changes and merge.</span></span> <span data-ttu-id="1c496-198">System kontroli źródła prawdopodobnie będzie automatycznie scalić zmiany na poziomie kodu, ponieważ są one bardzo proste.</span><span class="sxs-lookup"><span data-stu-id="1c496-198">The source control system will likely be able to automatically merge the changes at the code level since they are very simple.</span></span> <span data-ttu-id="1c496-199">Stan dla deweloperów \#2 użytkownika lokalnego repozytorium po synchronizacji jest przedstawiony na poniższym rysunku.</span><span class="sxs-lookup"><span data-stu-id="1c496-199">The state of Developer \#2’s local repository after syncing is depicted in the following graphic.</span></span> 

![Ściągnij](~/ef6/media/pull.png)

<span data-ttu-id="1c496-201">W tym testowanie Developer \#2 można uruchomić **Update-Database** wykryje nowe **AddRating** migracji (nie został zastosowany do deweloperów \#2 bazy danych) i zastosować je.</span><span class="sxs-lookup"><span data-stu-id="1c496-201">At this stage Developer \#2 can run **Update-Database** which will detect the new **AddRating** migration (which hasn’t been applied to Developer \#2’s database) and apply it.</span></span> <span data-ttu-id="1c496-202">Teraz **ocena** kolumna zostanie dodana do **blogi** tabeli i bazy danych jest zsynchronizowany z modelu.</span><span class="sxs-lookup"><span data-stu-id="1c496-202">Now the **Rating** column is added to the **Blogs** table and the database is in sync with the model.</span></span>

<span data-ttu-id="1c496-203">Istnieje jednak kilka problemów:</span><span class="sxs-lookup"><span data-stu-id="1c496-203">There are a couple of problems though:</span></span>

1.  <span data-ttu-id="1c496-204">Mimo że **Update-Database** zastosuje **AddRating** migracji również zgłosi Ostrzeżenie: *nie można zaktualizować bazy danych, aby dopasować w bieżącym modelu, ponieważ istnieją oczekujące zmiany i Automatyczna migracja jest wyłączona...*</span><span class="sxs-lookup"><span data-stu-id="1c496-204">Although **Update-Database** will apply the **AddRating** migration it will also raise a warning: *Unable to update database to match the current model because there are pending changes and automatic migration is disabled…*</span></span>
    <span data-ttu-id="1c496-205">Problem polega na to, że migawka modelu przechowywane w ostatniej migracji (**AddReader**) brakuje **ocena** właściwość **blogu** (ponieważ nie było częścią modelu po Migracja została wygenerowana).</span><span class="sxs-lookup"><span data-stu-id="1c496-205">The problem is that the model snapshot stored in the last migration (**AddReader**) is missing the **Rating** property on **Blog** (since it wasn’t part of the model when the migration was generated).</span></span> <span data-ttu-id="1c496-206">Kod najpierw wykrywa, że model w ostatniej migracji nie jest zgodny z bieżącym modelu i wywołuje ostrzeżenie.</span><span class="sxs-lookup"><span data-stu-id="1c496-206">Code First detects that the model in the last migration doesn’t match the current model and raises the warning.</span></span>
2.  <span data-ttu-id="1c496-207">Uruchomiona jest aplikacja mogłoby spowodować InvalidOperationException o treści "*modelu kopii kontekstu"BloggingContext"została zmieniona od czasu utworzenia bazy danych. Należy wziąć pod uwagę przy użyciu migracje Code First w aktualizacji bazy danych..."*</span><span class="sxs-lookup"><span data-stu-id="1c496-207">Running the application would result in an InvalidOperationException stating that “*The model backing the 'BloggingContext' context has changed since the database was created. Consider using Code First Migrations to update the database…”*</span></span>
    <span data-ttu-id="1c496-208">Ponownie problem polega na migawki modelu, przechowywane w ostatniej migracji nie jest zgodna bieżącego modelu.</span><span class="sxs-lookup"><span data-stu-id="1c496-208">Again, the problem is the model snapshot stored in the last migration doesn’t match the current model.</span></span>
3.  <span data-ttu-id="1c496-209">Na koniec będzie oczekujemy, że działa **migracji Dodaj** teraz wygeneruje pusty migracji (ponieważ nie wprowadzono żadnych zmian do zastosowania do bazy danych).</span><span class="sxs-lookup"><span data-stu-id="1c496-209">Finally, we would expect running **Add-Migration** now would generate an empty migration (since there are no changes to apply to the database).</span></span> <span data-ttu-id="1c496-210">Ale ponieważ migracje porównuje bieżący model na jeden z ostatnich migracji (czyli Brak **ocena** właściwość) on zostanie faktycznie tworzenia szkieletu innego **AddColumn** wywołanie do dodania w **Ocena** kolumny.</span><span class="sxs-lookup"><span data-stu-id="1c496-210">But because migrations compares the current model to the one from the last migration (which is missing the **Rating** property) it will actually scaffold another **AddColumn** call to add in the **Rating** column.</span></span> <span data-ttu-id="1c496-211">Oczywiście, ta migracja może zakończyć się niepowodzeniem podczas **Update-Database** ponieważ **ocena** kolumna już istnieje.</span><span class="sxs-lookup"><span data-stu-id="1c496-211">Of course, this migration would fail during **Update-Database** because the **Rating** column already exists.</span></span>

## <a name="resolving-the-merge-conflict"></a><span data-ttu-id="1c496-212">Rozwiązywanie konfliktu scalania</span><span class="sxs-lookup"><span data-stu-id="1c496-212">Resolving the merge conflict</span></span>

<span data-ttu-id="1c496-213">Dobra wiadomość jest, że nie jest zbyt trudne do przeciwdziałania scalanie ręczne — pod warunkiem, że zrozumienie sposobu działania migracji.</span><span class="sxs-lookup"><span data-stu-id="1c496-213">The good news is that it’s not too hard to deal with the merge manually – provided you have an understanding of how migrations works.</span></span> <span data-ttu-id="1c496-214">Jeśli zostały pominięte w sekcji do tej sekcji...</span><span class="sxs-lookup"><span data-stu-id="1c496-214">So if you’ve skipped ahead to this section…</span></span> <span data-ttu-id="1c496-215">Niestety musisz przejść wstecz i czytania dalszej części tego artykułu, najpierw!</span><span class="sxs-lookup"><span data-stu-id="1c496-215">sorry, you need to go back and read the rest of the article first!</span></span>

<span data-ttu-id="1c496-216">Dostępne są dwie opcje najprostsza polega na generowaniu puste migracji, który ma poprawne bieżący model jako migawka.</span><span class="sxs-lookup"><span data-stu-id="1c496-216">There are two options, the easiest is to generate a blank migration that has the correct current model as a snapshot.</span></span> <span data-ttu-id="1c496-217">Drugą opcją jest aktualizacja migawki w ostatniej migracji ma poprawny model migawki.</span><span class="sxs-lookup"><span data-stu-id="1c496-217">The second option is to update the snapshot in the last migration to have the correct model snapshot.</span></span> <span data-ttu-id="1c496-218">Drugą opcją jest nieco trudniejsze i nie można użyć w każdym scenariuszu, ale jest również bardziej przejrzysty, ponieważ nie wymaga, dodanie dodatkowych migracji.</span><span class="sxs-lookup"><span data-stu-id="1c496-218">The second option is a little harder and can’t be used in every scenario, but it’s also cleaner because it doesn’t involve adding an extra migration.</span></span>

### <a name="option-1-add-a-blank-merge-migration"></a><span data-ttu-id="1c496-219">Opcja 1: Dodaj migrację puste scalania</span><span class="sxs-lookup"><span data-stu-id="1c496-219">Option 1: Add a blank ‘merge’ migration</span></span>

<span data-ttu-id="1c496-220">W przypadku tej opcji, wygenerowanie pustego migracji wyłącznie w celu umożliwienia się, że najnowsze migracji ma w nim przechowywane migawki poprawny model.</span><span class="sxs-lookup"><span data-stu-id="1c496-220">In this option we generate a blank migration solely for the purpose of making sure the latest migration has the correct model snapshot stored in it.</span></span>

<span data-ttu-id="1c496-221">Ta opcja może służyć niezależnie od wartości która wygenerowała ostatniej migracji.</span><span class="sxs-lookup"><span data-stu-id="1c496-221">This option can be used regardless of who generated the last migration.</span></span> <span data-ttu-id="1c496-222">W przykładzie, możemy wykonywano Developer \#2 jest zwracając szczególną uwagę scalania i ich wystąpienia, aby wygenerować ostatniej migracji.</span><span class="sxs-lookup"><span data-stu-id="1c496-222">In the example we’ve been following Developer \#2 is taking care of the merge and they happened to generate the last migration.</span></span> <span data-ttu-id="1c496-223">Ale te same kroki mogą być używane, jeśli deweloper \#1 generowane ostatniej migracji.</span><span class="sxs-lookup"><span data-stu-id="1c496-223">But these same steps can be used if Developer \#1 generated the last migration.</span></span> <span data-ttu-id="1c496-224">Te kroki mają zastosowanie, jeśli wiele migracji są zaangażowani — firma Microsoft została właśnie zostało spojrzenie na dwa w celu uproszczenia.</span><span class="sxs-lookup"><span data-stu-id="1c496-224">The steps also apply if there are multiple migrations involved – we’ve just been looking at two in order to keep it simple.</span></span>

<span data-ttu-id="1c496-225">Następujący proces może służyć w tym podejściu, rozpoczynając od godziny, o których należy pamiętać, że masz zmiany, które muszą zostać zsynchronizowane z kontroli źródła.</span><span class="sxs-lookup"><span data-stu-id="1c496-225">The following process can be used for this approach, starting from the time you realize you have changes that need to be synced from source control.</span></span>

1.  <span data-ttu-id="1c496-226">Upewnij się, że wszelkie zmiany oczekujące modelu w kodzie lokalnych, zostały zapisane w migracji.</span><span class="sxs-lookup"><span data-stu-id="1c496-226">Ensure any pending model changes in your local code base have been written to a migration.</span></span> <span data-ttu-id="1c496-227">Ten krok zapewnia, że nie przegap wszelkie uzasadnione zmiany, kiedy nastąpi moment, aby wygenerować pusty migracji.</span><span class="sxs-lookup"><span data-stu-id="1c496-227">This step ensures you don’t miss any legitimate changes when it comes time to generate the blank migration.</span></span>
2.  <span data-ttu-id="1c496-228">Synchronizowanie z kontrolą źródła.</span><span class="sxs-lookup"><span data-stu-id="1c496-228">Sync with source control.</span></span>
3.  <span data-ttu-id="1c496-229">Uruchom **Update-Database** do zastosowania nowej migracji, które zostały zaewidencjonowane innym deweloperom.</span><span class="sxs-lookup"><span data-stu-id="1c496-229">Run **Update-Database** to apply any new migrations that other developers have checked in.</span></span>
    <span data-ttu-id="1c496-230">**_Uwaga:_**  *Jeśli nie dostaniesz żadnych ostrzeżeń polecenia Update-Database nie było żadnych nowych migracje od innych deweloperów i trzeba wykonywać dalszych scalania.*</span><span class="sxs-lookup"><span data-stu-id="1c496-230">**_Note:_** *if you don’t get any warnings from the Update-Database command then there were no new migrations from other developers and there is no need to perform any further merging.*</span></span>
4.  <span data-ttu-id="1c496-231">Uruchom **migracji Dodaj &lt;wybierz\_\_nazwa&gt; — IgnoreChanges** (na przykład **scalania migracji Dodaj — IgnoreChanges**).</span><span class="sxs-lookup"><span data-stu-id="1c496-231">Run **Add-Migration &lt;pick\_a\_name&gt; –IgnoreChanges** (for example, **Add-Migration Merge –IgnoreChanges**).</span></span> <span data-ttu-id="1c496-232">To generuje migracji za pomocą wszystkich metadanych (w tym migawki bieżącego modelu), ale będzie ignorować wszelkie zmiany wykrycia podczas porównywania bieżący model z migawką w ostatnim migracji (co oznacza, Pobierz pusty **się** i **Dół** metody).</span><span class="sxs-lookup"><span data-stu-id="1c496-232">This generates a migration with all the metadata (including a snapshot of the current model) but will ignore any changes it detects when comparing the current model to the snapshot in the last migrations (meaning you get a blank **Up** and **Down** method).</span></span>
5.  <span data-ttu-id="1c496-233">Kontynuować tworzenie lub Prześlij do kontroli źródła (po wykonywania z testów jednostkowych oczywiście).</span><span class="sxs-lookup"><span data-stu-id="1c496-233">Continue developing, or submit to source control (after running your unit tests of course).</span></span>

<span data-ttu-id="1c496-234">W tym miejscu jest stan dla deweloperów \#2 użytkownika lokalnego kodu bazowego po zakończeniu korzystania z tej metody.</span><span class="sxs-lookup"><span data-stu-id="1c496-234">Here is the state of Developer \#2’s local code base after using this approach.</span></span>

![Scal migracji](~/ef6/media/mergemigration.png)

### <a name="option-2-update-the-model-snapshot-in-the-last-migration"></a><span data-ttu-id="1c496-236">Opcja 2: Zaktualizuj migawkę modelu w ostatniej migracji</span><span class="sxs-lookup"><span data-stu-id="1c496-236">Option 2: Update the model snapshot in the last migration</span></span>

<span data-ttu-id="1c496-237">Ta opcja jest bardzo podobna do opcji 1, ale usuwa dodatkowe puste migracji —, ponieważ umożliwia prawdzie, kto chce, aby pliki dodatkowego kodu w swoich rozwiązaniach.</span><span class="sxs-lookup"><span data-stu-id="1c496-237">This option is very similar to option 1 but removes the extra blank migration – because let’s face it, who wants extra code files in their solution.</span></span>

<span data-ttu-id="1c496-238">**To podejście jest możliwe tylko, jeśli istnieje tylko w podstawowym kod lokalny najnowszych migracji, a nie jeszcze został przesłany do kontroli źródła (na przykład, jeśli ostatni migracji został wygenerowany przez użytkownika, wykonując scalanie)**.</span><span class="sxs-lookup"><span data-stu-id="1c496-238">**This approach is only feasible if the latest migration exists only in your local code base and has not yet been submitted to source control (for example, if the last migration was generated by the user doing the merge)**.</span></span> <span data-ttu-id="1c496-239">Edytować metadane migracji, które inni deweloperzy już zastosowane do swojej bazy danych rozwoju — lub nawet co gorsza stosowane do produkcyjnej bazy danych — może spowodować nieoczekiwane działania niepożądane.</span><span class="sxs-lookup"><span data-stu-id="1c496-239">Editing the metadata of migrations that other developers may have already applied to their development database – or even worse applied to a production database – can result in unexpected side effects.</span></span> <span data-ttu-id="1c496-240">W procesie zamierzamy wycofać migrację ostatni w naszym lokalnej bazy danych, a następnie ponownie zastosuj go ze zaktualizowanymi metadanymi.</span><span class="sxs-lookup"><span data-stu-id="1c496-240">During the process we’re going to roll back the last migration in our local database and re-apply it with updated metadata.</span></span>

<span data-ttu-id="1c496-241">Podczas ostatniej migracji konieczne po prostu znajdować się w lokalnym kod podstawowy, nie ma żadnych ograniczeń liczbę lub kolejność migracji, które ją kontynuować.</span><span class="sxs-lookup"><span data-stu-id="1c496-241">While the last migration needs to just be in the local code base there are no restrictions to the number or order of migrations that proceed it.</span></span> <span data-ttu-id="1c496-242">Może istnieć wiele migracji z wielu różnych deweloperów i Zastosuj te same czynności — firma Microsoft została właśnie zostało spojrzenie na dwa w celu uproszczenia.</span><span class="sxs-lookup"><span data-stu-id="1c496-242">There can be multiple migrations from multiple different developers and the same steps apply– we’ve just been looking at two in order to keep it simple.</span></span>

<span data-ttu-id="1c496-243">Następujący proces może służyć w tym podejściu, rozpoczynając od godziny, o których należy pamiętać, że masz zmiany, które muszą zostać zsynchronizowane z kontroli źródła.</span><span class="sxs-lookup"><span data-stu-id="1c496-243">The following process can be used for this approach, starting from the time you realize you have changes that need to be synced from source control.</span></span>

1.  <span data-ttu-id="1c496-244">Upewnij się, że wszelkie zmiany oczekujące modelu w kodzie lokalnych, zostały zapisane w migracji.</span><span class="sxs-lookup"><span data-stu-id="1c496-244">Ensure any pending model changes in your local code base have been written to a migration.</span></span> <span data-ttu-id="1c496-245">Ten krok zapewnia, że nie przegap wszelkie uzasadnione zmiany, kiedy nastąpi moment, aby wygenerować pusty migracji.</span><span class="sxs-lookup"><span data-stu-id="1c496-245">This step ensures you don’t miss any legitimate changes when it comes time to generate the blank migration.</span></span>
2.  <span data-ttu-id="1c496-246">Synchronizowanie z kontrolą źródła.</span><span class="sxs-lookup"><span data-stu-id="1c496-246">Sync with the source control.</span></span>
3.  <span data-ttu-id="1c496-247">Uruchom **Update-Database** do zastosowania nowej migracji, które zostały zaewidencjonowane innym deweloperom.</span><span class="sxs-lookup"><span data-stu-id="1c496-247">Run **Update-Database** to apply any new migrations that other developers have checked in.</span></span>
    <span data-ttu-id="1c496-248">**_Uwaga:_**  *Jeśli nie dostaniesz żadnych ostrzeżeń polecenia Update-Database nie było żadnych nowych migracje od innych deweloperów i trzeba wykonywać dalszych scalania.*</span><span class="sxs-lookup"><span data-stu-id="1c496-248">**_Note:_** *if you don’t get any warnings from the Update-Database command then there were no new migrations from other developers and there is no need to perform any further merging.*</span></span>
4.  <span data-ttu-id="1c496-249">Uruchom **Update-Database-TargetMigration &lt;drugi\_ostatniego\_migracji&gt;**  (w przykładzie, możemy wykonywano takie rozwiązanie byłoby **aktualizacji bazy danych — TargetMigration AddRating**).</span><span class="sxs-lookup"><span data-stu-id="1c496-249">Run **Update-Database –TargetMigration &lt;second\_last\_migration&gt;** (in the example we’ve been following this would be **Update-Database –TargetMigration AddRating**).</span></span> <span data-ttu-id="1c496-250">To role bazy danych z powrotem do stanu drugiego ostatnie migracji — skutecznie "bez stosowania" ostatniej migracji z bazy danych.</span><span class="sxs-lookup"><span data-stu-id="1c496-250">This roles the database back to the state of the second last migration – effectively ‘un-applying’ the last migration from the database.</span></span>
    <span data-ttu-id="1c496-251">**_Uwaga:_**  *ten krok jest wymagany, aby bezpiecznie edytować metadane migracji, ponieważ metadane są również przechowywane w \_ \_MigrationsHistoryTable bazy danych. Jest to, dlaczego tej opcji należy używać tylko, jeśli ostatni migracji jest tylko w lokalnej bazie kodu. Jeśli innych baz danych było ostatniej migracji, które są stosowane również masz do nich wycofać, a następnie ponownie zastosuj ostatniej migracji w celu zaktualizowania metadanych.*</span><span class="sxs-lookup"><span data-stu-id="1c496-251">**_Note:_** *This step is required to make it safe to edit the metadata of the migration since the metadata is also stored in the \_\_MigrationsHistoryTable of the database. This is why you should only use this option if the last migration is only in your local code base. If other databases had the last migration applied you would also have to roll them back and re-apply the last migration to update the metadata.*</span></span> 
5.  <span data-ttu-id="1c496-252">Uruchom **migracji Dodaj &lt;pełną\_nazwa\_tym\_sygnatura czasowa\_z\_ostatniego\_migracji** &gt; (w tym przykładzie Firma Microsoft wykonywano powinien to być podobny do **201311062215252 migracji Dodaj\_AddReaders**).</span><span class="sxs-lookup"><span data-stu-id="1c496-252">Run **Add-Migration &lt;full\_name\_including\_timestamp\_of\_last\_migration**&gt; (in the example we’ve been following this would be something like **Add-Migration 201311062215252\_AddReaders**).</span></span>
    <span data-ttu-id="1c496-253">**_Uwaga:_**  *muszą zawierać sygnaturę czasową, aby migracje wie, którą chcesz edytować istniejące migracji, a nie tworzenia szkieletów nową.*</span><span class="sxs-lookup"><span data-stu-id="1c496-253">**_Note:_** *You need to include the timestamp so that migrations knows you want to edit the existing migration rather than scaffolding a new one.*</span></span>
    <span data-ttu-id="1c496-254">Spowoduje to zaktualizowanie metadanych dla ostatniej migracji do dopasowania w bieżącym modelu.</span><span class="sxs-lookup"><span data-stu-id="1c496-254">This will update the metadata for the last migration to match the current model.</span></span> <span data-ttu-id="1c496-255">Po wykonaniu polecenia, ale jest to dokładnie co chcesz otrzymasz następujące ostrzeżenie.</span><span class="sxs-lookup"><span data-stu-id="1c496-255">You’ll get the following warning when the command completes, but that’s exactly what you want.</span></span> <span data-ttu-id="1c496-256">"*Tylko kodu projektanta do migracji" 201311062215252\_AddReaders został ponownie utworzony szkielet. Aby ponownie utworzyć szkielet całego migracji, należy użyć parametru - Force. "*</span><span class="sxs-lookup"><span data-stu-id="1c496-256">“*Only the Designer Code for migration '201311062215252\_AddReaders' was re-scaffolded. To re-scaffold the entire migration, use the -Force parameter.”*</span></span>
6.  <span data-ttu-id="1c496-257">Uruchom **Update-Database** Ponowne zgłoszenie chęci najnowszych migracji ze zaktualizowanymi metadanymi.</span><span class="sxs-lookup"><span data-stu-id="1c496-257">Run **Update-Database** to re-apply the latest migration with the updated metadata.</span></span>
7.  <span data-ttu-id="1c496-258">Kontynuować tworzenie lub Prześlij do kontroli źródła (po wykonywania z testów jednostkowych oczywiście).</span><span class="sxs-lookup"><span data-stu-id="1c496-258">Continue developing, or submit to source control (after running your unit tests of course).</span></span>

<span data-ttu-id="1c496-259">W tym miejscu jest stan dla deweloperów \#2 użytkownika lokalnego kodu bazowego po zakończeniu korzystania z tej metody.</span><span class="sxs-lookup"><span data-stu-id="1c496-259">Here is the state of Developer \#2’s local code base after using this approach.</span></span>

![Aktualizacja metadanych](~/ef6/media/updatedmetadata.png)

## <a name="summary"></a><span data-ttu-id="1c496-261">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="1c496-261">Summary</span></span>

<span data-ttu-id="1c496-262">Istnieją niektóre wyzwania, korzystając z migracje Code First w środowisko pracy dla zespołu.</span><span class="sxs-lookup"><span data-stu-id="1c496-262">There are some challenges when using Code First Migrations in a team environment.</span></span> <span data-ttu-id="1c496-263">Jednak podstawową wiedzę na temat sposobu działania migracji i niektóre proste podejścia do rozwiązywania konfliktów scalania ułatwiają przezwyciężyć te wyzwania.</span><span class="sxs-lookup"><span data-stu-id="1c496-263">However, a basic understanding of how migrations works and some simple approaches for resolving merge conflicts make it easy to overcome these challenges.</span></span>

<span data-ttu-id="1c496-264">Podstawowe problem jest nieprawidłowa z metadanych najnowszych migracji.</span><span class="sxs-lookup"><span data-stu-id="1c496-264">The fundamental issue is incorrect metadata stored in the latest migration.</span></span> <span data-ttu-id="1c496-265">Powoduje to Code First nieprawidłowo wykrywa, że bieżący model i schemat bazy danych nie są zgodne i tworzenia szkieletu niepoprawny kod w następnej migracji.</span><span class="sxs-lookup"><span data-stu-id="1c496-265">This causes Code First to incorrectly detect that the current model and database schema don’t match and to scaffold incorrect code in the next migration.</span></span> <span data-ttu-id="1c496-266">Takiej sytuacji można rozwiązać przez generowanie puste migracji za pomocą modelu poprawne lub zaktualizowanie metadanych w najnowszych migracji.</span><span class="sxs-lookup"><span data-stu-id="1c496-266">This situation can be overcome by generating a blank migration with the correct model, or updating the metadata in the latest migration.</span></span>
