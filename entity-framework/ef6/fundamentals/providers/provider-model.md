---
title: Model dostawcy platformy Entity Framework 6 — EF6
author: divega
ms.date: 06/27/2018
ms.assetid: 066832F0-D51B-4655-8BE7-C983C557E0E4
ms.openlocfilehash: 8cbf6f87e0936f374c3d8a0c15a0e1d9c828f764
ms.sourcegitcommit: 159c2e9afed7745e7512730ffffaf154bcf2ff4a
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 02/03/2019
ms.locfileid: "55668755"
---
# <a name="the-entity-framework-6-provider-model"></a><span data-ttu-id="f1410-102">Dostawca modelu Entity Framework 6</span><span class="sxs-lookup"><span data-stu-id="f1410-102">The Entity Framework 6 provider model</span></span>

<span data-ttu-id="f1410-103">Model dostawcy programu Entity Framework umożliwia Entity Framework ma być używany z różnymi typami serwera bazy danych.</span><span class="sxs-lookup"><span data-stu-id="f1410-103">The Entity Framework provider model allows Entity Framework to be used with different types of database server.</span></span> <span data-ttu-id="f1410-104">Na przykład jeden dostawca można podłączyć umożliwia EF ma być używany dla programu Microsoft SQL Server, podczas gdy umożliwia EF ma być używany dla programu Microsoft SQL Server Compact Edition można podłączyć do innego dostawcy.</span><span class="sxs-lookup"><span data-stu-id="f1410-104">For example, one provider can be plugged in to allow EF to be used against Microsoft SQL Server, while another provider can be plugged into to allow EF to be used against Microsoft SQL Server Compact Edition.</span></span> <span data-ttu-id="f1410-105">Dostawcy dla platformy EF6, które sobie sprawę z znajduje się na [dostawcy programu Entity Framework](~/ef6/fundamentals/providers/index.md) strony.</span><span class="sxs-lookup"><span data-stu-id="f1410-105">The providers for EF6 that we are aware of can be found on the [Entity Framework providers](~/ef6/fundamentals/providers/index.md) page.</span></span>

<span data-ttu-id="f1410-106">Niektóre zmiany były wymagane do metody, gdy EF wchodzi w interakcję z dostawcami, aby umożliwić EF mogą być wprowadzane w ramach licencji open source.</span><span class="sxs-lookup"><span data-stu-id="f1410-106">Certain changes were required to the way EF interacts with providers to allow EF to be released under an open source license.</span></span> <span data-ttu-id="f1410-107">Te zmiany wymagają odbudowywania EF dostawców dla zestawów platformy EF6 wraz z nowe mechanizmy Rejestracja dostawcy.</span><span class="sxs-lookup"><span data-stu-id="f1410-107">These changes require rebuilding of EF providers against the EF6 assemblies together with new mechanisms for registration of the provider.</span></span>

## <a name="rebuilding"></a><span data-ttu-id="f1410-108">Ponowne tworzenie</span><span class="sxs-lookup"><span data-stu-id="f1410-108">Rebuilding</span></span>

<span data-ttu-id="f1410-109">Przy użyciu platformy EF6 kodu core, który został wcześniej częścią programu .NET Framework jest teraz są dostarczane jako poza pasmem (OOB), zestawy.</span><span class="sxs-lookup"><span data-stu-id="f1410-109">With EF6 the core code that was previously part of the .NET Framework is now being shipped as out-of-band (OOB) assemblies.</span></span> <span data-ttu-id="f1410-110">Szczegółowe informacje na temat tworzenia aplikacji w ramach platformy EF6 znajduje się na [aktualizowania aplikacji dla platformy EF6](~/ef6/what-is-new/upgrading-to-ef6.md) strony.</span><span class="sxs-lookup"><span data-stu-id="f1410-110">Details on how to build applications against EF6 can be found on the [Updating applications for EF6](~/ef6/what-is-new/upgrading-to-ef6.md) page.</span></span> <span data-ttu-id="f1410-111">Dostawców będzie również trzeba odbudować, korzystając z tych instrukcji.</span><span class="sxs-lookup"><span data-stu-id="f1410-111">Providers will also need to be rebuilt using these instructions.</span></span>

## <a name="provider-types-overview"></a><span data-ttu-id="f1410-112">Przegląd typów dostawcy</span><span class="sxs-lookup"><span data-stu-id="f1410-112">Provider types overview</span></span>

<span data-ttu-id="f1410-113">Dostawca usługi EF jest naprawdę kolekcja właściwe dla dostawcy usług zdefiniowane przez typy CLR, które tych usług rozszerza z (dla klasy bazowej) ani nie implementuje (w przypadku interfejsu).</span><span class="sxs-lookup"><span data-stu-id="f1410-113">An EF provider is really a collection of provider-specific services defined by CLR types that these services extend from (for a base class) or implement (for an interface).</span></span> <span data-ttu-id="f1410-114">Są dwa z tych usług podstawowych i niezbędne dla platformy EF w ogóle działać.</span><span class="sxs-lookup"><span data-stu-id="f1410-114">Two of these services are fundamental and necessary for EF to function at all.</span></span> <span data-ttu-id="f1410-115">Inne są opcjonalne i wystarczy do zaimplementowania Jeśli określonych jest wymagane i/lub domyślnej implementacji tych usług nie działa dla konkretnej bazy danych serwer docelowy.</span><span class="sxs-lookup"><span data-stu-id="f1410-115">Others are optional and only need to be implemented if specific functionality is required and/or the default implementations of these services does not work for the specific database server being targeted.</span></span>

## <a name="fundamental-provider-types"></a><span data-ttu-id="f1410-116">Typy podstawowe dostawców</span><span class="sxs-lookup"><span data-stu-id="f1410-116">Fundamental provider types</span></span>

### <a name="dbproviderfactory"></a><span data-ttu-id="f1410-117">DbProviderFactory</span><span class="sxs-lookup"><span data-stu-id="f1410-117">DbProviderFactory</span></span>

<span data-ttu-id="f1410-118">EF zależy od tego, typ pochodzący od posiadania [System.Data.Common.DbProviderFactory](https://msdn.microsoft.com/library/system.data.common.dbproviderfactory.aspx) do wykonywania wszystkich dostęp do niskiego poziomu bazy danych.</span><span class="sxs-lookup"><span data-stu-id="f1410-118">EF depends on having a type derived from [System.Data.Common.DbProviderFactory](https://msdn.microsoft.com/library/system.data.common.dbproviderfactory.aspx) for performing all low-level database access.</span></span> <span data-ttu-id="f1410-119">DbProviderFactory nie jest częścią platformy EF, lecz dotyczy klasy w .NET Framework, która służy punkt wejścia dla dostawcy ADO.NET, który może służyć przez EF, O/RMs lub bezpośrednio przez aplikację można uzyskać rodzajami połączeń, polecenia, parametry i inne abstrakcje ADO.NET dostawcy sposób niezależny od.</span><span class="sxs-lookup"><span data-stu-id="f1410-119">DbProviderFactory is not actually part of EF but is instead a class in the .NET Framework that serves an entry point for ADO.NET providers that can be used by EF, other O/RMs or directly by an application to obtain instances of connections, commands, parameters and other ADO.NET abstractions in a provider agnostic way.</span></span> <span data-ttu-id="f1410-120">Więcej informacji na temat DbProviderFactory znajdują się w [dokumentacji MSDN dotyczącej ADO.NET](https://msdn.microsoft.com/library/a6cd7c08.aspx).</span><span class="sxs-lookup"><span data-stu-id="f1410-120">More information about DbProviderFactory can be found in the [MSDN documentation for ADO.NET](https://msdn.microsoft.com/library/a6cd7c08.aspx).</span></span>

### <a name="dbproviderservices"></a><span data-ttu-id="f1410-121">DbProviderServices</span><span class="sxs-lookup"><span data-stu-id="f1410-121">DbProviderServices</span></span>

<span data-ttu-id="f1410-122">EF zależy od tego, mające typ pochodzący od DbProviderServices zapewniające dodatkowe funkcje wymagane przez EF na podstawie funkcje już udostępniane przez dostawcę danych ADO.NET.</span><span class="sxs-lookup"><span data-stu-id="f1410-122">EF depends on having a type derived from DbProviderServices for providing additional functionality needed by EF on top of the functionality already provided by the ADO.NET provider.</span></span> <span data-ttu-id="f1410-123">W starszych wersjach programu EF klasy DbProviderServices było częścią programu .NET Framework i został znaleziony w przestrzeni nazw System.Data.Common.</span><span class="sxs-lookup"><span data-stu-id="f1410-123">In older versions of EF the DbProviderServices class was part of the .NET Framework and was found in the System.Data.Common namespace.</span></span> <span data-ttu-id="f1410-124">Począwszy od platformy EF6 tej klasy jest teraz częścią EntityFramework.dll i znajduje się w przestrzeni nazw System.Data.Entity.Core.Common.</span><span class="sxs-lookup"><span data-stu-id="f1410-124">Starting with EF6 this class is now part of EntityFramework.dll and is in the System.Data.Entity.Core.Common namespace.</span></span>

<span data-ttu-id="f1410-125">Więcej informacji na temat podstawowych funkcji implementacji DbProviderServices znajduje się na [MSDN](https://msdn.microsoft.com/library/ee789835.aspx).</span><span class="sxs-lookup"><span data-stu-id="f1410-125">More details about the fundamental functionality of a DbProviderServices implementation can be found on [MSDN](https://msdn.microsoft.com/library/ee789835.aspx).</span></span> <span data-ttu-id="f1410-126">Jednak należy pamiętać, że od czasu zapisania tych informacji nie jest aktualizowana dla platformy EF6 mimo że większość koncepcji są nadal ważne.</span><span class="sxs-lookup"><span data-stu-id="f1410-126">However, note that as of the time of writing this information is not updated for EF6 although most of the concepts are still valid.</span></span> <span data-ttu-id="f1410-127">Implementacji programu SQL Server i programu SQL Server Compact DbProviderServices również są sprawdzane w celu [bazy kodu typu open-source](https://github.com/aspnet/EntityFramework6/) i może służyć jako przydatne dane dla innych implementacji.</span><span class="sxs-lookup"><span data-stu-id="f1410-127">The SQL Server and SQL Server Compact implementations of DbProviderServices are also checked into to the [open-source codebase](https://github.com/aspnet/EntityFramework6/) and can serve as useful references for other implementations.</span></span>

<span data-ttu-id="f1410-128">W starszych wersjach programu EF implementacji DbProviderServices używać pochodzi bezpośrednio od dostawcy ADO.NET.</span><span class="sxs-lookup"><span data-stu-id="f1410-128">In older versions of EF the DbProviderServices implementation to use was obtained directly from an ADO.NET provider.</span></span> <span data-ttu-id="f1410-129">Zostało to zrobione, rzutowanie DbProviderFactory na IServiceProvider i wywołanie metody GetService.</span><span class="sxs-lookup"><span data-stu-id="f1410-129">This was done by casting DbProviderFactory to IServiceProvider and calling the GetService method.</span></span> <span data-ttu-id="f1410-130">To ściśle powiązane dostawcy EF DbProviderFactory.</span><span class="sxs-lookup"><span data-stu-id="f1410-130">This tightly coupled the EF provider to the DbProviderFactory.</span></span> <span data-ttu-id="f1410-131">Ta sprzężenia zablokowany EF jest przenoszony z .NET Framework i w związku z tym dla platformy EF6 to ścisłego sprzężenia została usunięta, a implementacja DbProviderServices jest obecnie zarejestrowany bezpośrednio w pliku konfiguracji aplikacji lub oparte na kodzie Konfiguracja opisany bardziej szczegółowo _rejestrowanie DbProviderServices_ poniższej sekcji.</span><span class="sxs-lookup"><span data-stu-id="f1410-131">This coupling blocked EF from being moved out of the .NET Framework and therefore for EF6 this tight coupling has been removed and an implementation of DbProviderServices is now registered directly in the application’s configuration file or in code-based configuration as described in more detail the _Registering DbProviderServices_ section below.</span></span>

## <a name="additional-services"></a><span data-ttu-id="f1410-132">Usługi dodatkowe</span><span class="sxs-lookup"><span data-stu-id="f1410-132">Additional services</span></span>

<span data-ttu-id="f1410-133">Oprócz podstawowych usług opisanych powyżej są również wiele innych usług używanych przez EF, które są zawsze lub czasami specyficzne dla dostawcy.</span><span class="sxs-lookup"><span data-stu-id="f1410-133">In addition to the fundamental services described above there are also many other services used by EF which are either always or sometimes provider-specific.</span></span> <span data-ttu-id="f1410-134">Domyślnej implementacji właściwe dla dostawcy, te usługi mogą być dostarczane przez implementację DbProviderServices.</span><span class="sxs-lookup"><span data-stu-id="f1410-134">Default provider-specific implementations of these services can be supplied by a DbProviderServices implementation.</span></span> <span data-ttu-id="f1410-135">Aplikacje można również zastąpić implementacji tych usług lub dostarczać implementacje, gdy typem DbProviderServices nie dostarcza domyślny.</span><span class="sxs-lookup"><span data-stu-id="f1410-135">Applications can also override the implementations of these services, or provide implementations when a DbProviderServices type does not provide a default.</span></span> <span data-ttu-id="f1410-136">Jest to opisane bardziej szczegółowo w _rozpoznawanie dodatkowych usług_ poniższej sekcji.</span><span class="sxs-lookup"><span data-stu-id="f1410-136">This is described in more detail in the _Resolving additional services_ section below.</span></span>

<span data-ttu-id="f1410-137">Poniżej przedstawiono typy dodatkowych usług, które dostawcy mogą być przydatne do dostawcy.</span><span class="sxs-lookup"><span data-stu-id="f1410-137">The additional service types that a provider may be of interest to a provider are listed below.</span></span> <span data-ttu-id="f1410-138">Więcej szczegółów na temat każdego z tych typów usług można znaleźć w dokumentacji interfejsu API.</span><span class="sxs-lookup"><span data-stu-id="f1410-138">More details about each of these service types can be found in the API documentation.</span></span>

### <a name="idbexecutionstrategy"></a><span data-ttu-id="f1410-139">IDbExecutionStrategy</span><span class="sxs-lookup"><span data-stu-id="f1410-139">IDbExecutionStrategy</span></span>

<span data-ttu-id="f1410-140">Jest to opcjonalna usługa, która umożliwia dostawcy zaimplementować ponownych prób lub inne zachowanie, gdy zapytań i poleceń, które są wykonywane względem bazy danych.</span><span class="sxs-lookup"><span data-stu-id="f1410-140">This is an optional service that allows a provider to implement retries or other behavior when queries and commands are executed against the database.</span></span> <span data-ttu-id="f1410-141">Jeśli nie dostarczono żadnej implementacji, EF będzie po prostu wykonaj polecenia i propagowanie wyjątki zgłaszane.</span><span class="sxs-lookup"><span data-stu-id="f1410-141">If no implementation is provided, then EF will simply execute the commands and propagate any exceptions thrown.</span></span> <span data-ttu-id="f1410-142">Dla programu SQL Server ta usługa służy do zapewnienia zasady ponawiania, co jest szczególnie przydatne, jeśli działających w odniesieniu do serwerów bazy danych opartej na chmurze, takich jak SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="f1410-142">For SQL Server this service is used to provide a retry policy which is especially useful when running against cloud-based database servers such as SQL Azure.</span></span>

### <a name="idbconnectionfactory"></a><span data-ttu-id="f1410-143">IDbConnectionFactory</span><span class="sxs-lookup"><span data-stu-id="f1410-143">IDbConnectionFactory</span></span>

<span data-ttu-id="f1410-144">Jest to opcjonalna usługa, która umożliwia dostawcy utworzyć obiekty DbConnection zgodnie z Konwencją, gdy podana nazwa bazy danych.</span><span class="sxs-lookup"><span data-stu-id="f1410-144">This is an optional service that allows a provider to create DbConnection objects by convention when given only a database name.</span></span> <span data-ttu-id="f1410-145">Należy pamiętać, że gdy ta usługa może zostać rozpoznana przez implementację DbProviderServices została już obecne od EF 4.1 i może również być jawnie ustawione w pliku konfiguracji lub w kodzie.</span><span class="sxs-lookup"><span data-stu-id="f1410-145">Note that while this service can be resolved by a DbProviderServices implementation it has been present since EF 4.1 and can also be explicitly set in either the config file or in code.</span></span> <span data-ttu-id="f1410-146">Dostawca tylko otrzymają Państwo rozpoznać tej usługi, jeśli on zarejestrowany jako domyślnego dostawcę (zobacz _domyślny dostawca_ poniżej) i jeśli domyślna fabryka połączenia nie został ustawiony gdzie indziej.</span><span class="sxs-lookup"><span data-stu-id="f1410-146">The provider will only get a chance to resolve this service if it registered as the default provider (see _The default provider_ below) and if a default connection factory has not been set elsewhere.</span></span>

### <a name="dbspatialservices"></a><span data-ttu-id="f1410-147">DbSpatialServices</span><span class="sxs-lookup"><span data-stu-id="f1410-147">DbSpatialServices</span></span>

<span data-ttu-id="f1410-148">Jest to opcjonalne usług, które umożliwia dostawcy dodać obsługę typów przestrzennych geometry i położenia geograficznego.</span><span class="sxs-lookup"><span data-stu-id="f1410-148">This is an optional services that allows a provider to add support for geography and geometry spatial types.</span></span> <span data-ttu-id="f1410-149">Implementacja tej usługi należy podać w kolejności dla aplikacji EF za pomocą typów przestrzennych.</span><span class="sxs-lookup"><span data-stu-id="f1410-149">An implementation of this service must be supplied in order for an application to use EF with spatial types.</span></span> <span data-ttu-id="f1410-150">DbSptialServices zostanie poproszony o na dwa sposoby.</span><span class="sxs-lookup"><span data-stu-id="f1410-150">DbSptialServices is asked for in two ways.</span></span> <span data-ttu-id="f1410-151">Po pierwsze, właściwe dla dostawcy usług przestrzennych, są żądane przy użyciu obiektu DbProviderInfo (zawierający niezmiennej token nazwy, a manifestu) jako klucza.</span><span class="sxs-lookup"><span data-stu-id="f1410-151">First, provider-specific spatial services are requested using a DbProviderInfo object (which contains invariant name and manifest token) as key.</span></span> <span data-ttu-id="f1410-152">Po drugie DbSpatialServices można monit o wpisanie bez klucza.</span><span class="sxs-lookup"><span data-stu-id="f1410-152">Second, DbSpatialServices can be asked for with no key.</span></span> <span data-ttu-id="f1410-153">Służy to rozwiązać "globalne przestrzenne dostawcę" użytą podczas tworzenia autonomicznego DbGeography lub DbGeometry typów.</span><span class="sxs-lookup"><span data-stu-id="f1410-153">This is used to resolve the “global spatial provider” that is used when creating stand-alone DbGeography or DbGeometry types.</span></span>

### <a name="migrationsqlgenerator"></a><span data-ttu-id="f1410-154">MigrationSqlGenerator</span><span class="sxs-lookup"><span data-stu-id="f1410-154">MigrationSqlGenerator</span></span>

<span data-ttu-id="f1410-155">Jest to opcjonalna usługa, która umożliwia migracji EF, służący do generowania SQL używane podczas tworzenia i modyfikowania schematy bazy danych przez rozwiązanie Code First.</span><span class="sxs-lookup"><span data-stu-id="f1410-155">This is an optional service that allows EF Migrations to be used for the generation of SQL used in creating and modifying database schemas by Code First.</span></span> <span data-ttu-id="f1410-156">Implementacja jest wymagana w celu zapewnienia obsługi migracji.</span><span class="sxs-lookup"><span data-stu-id="f1410-156">An implementation is required in order to support Migrations.</span></span> <span data-ttu-id="f1410-157">Jeśli podano implementację go będzie również użyte podczas tworzenia bazy danych przy użyciu metody Database.Create lub inicjatory bazy danych.</span><span class="sxs-lookup"><span data-stu-id="f1410-157">If an implementation is provided then it will also be used when databases are created using database initializers or the Database.Create method.</span></span>

### <a name="funcdbconnection-string-historycontextfactory"></a><span data-ttu-id="f1410-158">FUNC < DbConnection, string, HistoryContextFactory ></span><span class="sxs-lookup"><span data-stu-id="f1410-158">Func<DbConnection, string, HistoryContextFactory></span></span>

<span data-ttu-id="f1410-159">Jest to opcjonalna usługa, która umożliwia dostawcy skonfigurować mapowanie HistoryContext do `__MigrationHistory` tabeli używanej przez migracje EF.</span><span class="sxs-lookup"><span data-stu-id="f1410-159">This is an optional service that allows a provider to configure the mapping of the HistoryContext to the `__MigrationHistory` table used by EF Migrations.</span></span> <span data-ttu-id="f1410-160">HistoryContext jest pierwszy typu DbContext kodu i można skonfigurować przy użyciu normalnych wygodnego interfejsu API można zmienić elementów, takich jak nazwy tabeli i specyfikacji mapowania kolumn.</span><span class="sxs-lookup"><span data-stu-id="f1410-160">The HistoryContext is a Code First DbContext and can be configured using the normal fluent API to change things like the name of the table and the column mapping specifications.</span></span> <span data-ttu-id="f1410-161">Domyślna implementacja tej usługi dla wszystkich dostawców zwracane przez EF mogą działać w przypadku serwera bazy danych, jeśli wszystkie domyślne tabel i kolumn mapowania są obsługiwane przez tego dostawcę.</span><span class="sxs-lookup"><span data-stu-id="f1410-161">The default implementation of this service returned by EF for all providers may work for a given database server if all the default table and column mappings are supported by that provider.</span></span> <span data-ttu-id="f1410-162">W takim przypadku dostawca nie musi dostarczyć implementację tej usługi.</span><span class="sxs-lookup"><span data-stu-id="f1410-162">In such a case the provider does not need to supply an implementation of this service.</span></span>

### <a name="idbproviderfactoryresolver"></a><span data-ttu-id="f1410-163">IDbProviderFactoryResolver</span><span class="sxs-lookup"><span data-stu-id="f1410-163">IDbProviderFactoryResolver</span></span>

<span data-ttu-id="f1410-164">Jest to opcjonalne zapewniającej uzyskiwanie DbProviderFactory poprawne z danego obiektu DbConnection.</span><span class="sxs-lookup"><span data-stu-id="f1410-164">This is an optional service for obtaining the correct DbProviderFactory from a given DbConnection object.</span></span> <span data-ttu-id="f1410-165">Domyślna implementacja tej usługi dla wszystkich dostawców zwracane przez EF jest przeznaczony do pracy dla wszystkich dostawców.</span><span class="sxs-lookup"><span data-stu-id="f1410-165">The default implementation of this service returned by EF for all providers is intended to work for all providers.</span></span> <span data-ttu-id="f1410-166">Jednak podczas uruchamiania na .NET 4, DbProviderFactory nie jest dostępny publicznie w jeden jego DbConnections.</span><span class="sxs-lookup"><span data-stu-id="f1410-166">However, when running on .NET 4, the DbProviderFactory is not publicly accessible from one if its DbConnections.</span></span> <span data-ttu-id="f1410-167">W związku z tym EF używa niektóre heurystyki do wyszukiwania zarejestrowanych dostawców w celu znalezienia dopasowania.</span><span class="sxs-lookup"><span data-stu-id="f1410-167">Therefore, EF uses some heuristics to search the registered providers to find a match.</span></span> <span data-ttu-id="f1410-168">Istnieje możliwość, że w przypadku niektórych dostawców te algorytmy heurystyczne zakończy się niepowodzeniem, a w takich sytuacjach dostawcy należy podać nową metodę implementacji.</span><span class="sxs-lookup"><span data-stu-id="f1410-168">It is possible that for some providers these heuristics will fail and in such situations the provider should supply a new implementation.</span></span>

## <a name="registering-dbproviderservices"></a><span data-ttu-id="f1410-169">Rejestrowanie DbProviderServices</span><span class="sxs-lookup"><span data-stu-id="f1410-169">Registering DbProviderServices</span></span>

<span data-ttu-id="f1410-170">W pliku konfiguracji (app.config lub web.config) lub przy użyciu konfiguracji na podstawie kodu aplikacji można zarejestrować implementacji DbProviderServices do użycia.</span><span class="sxs-lookup"><span data-stu-id="f1410-170">The DbProviderServices implementation to use can be registered either in the application’s configuration file (app.config or web.config) or using code-based configuration.</span></span> <span data-ttu-id="f1410-171">W obu przypadkach rejestracji używa dostawcy "niezmiennej nazwie" jako klucza.</span><span class="sxs-lookup"><span data-stu-id="f1410-171">In either case the registration uses the provider’s “invariant name” as a key.</span></span> <span data-ttu-id="f1410-172">Dzięki temu wielu dostawców były rejestrowane i używane w jednej aplikacji.</span><span class="sxs-lookup"><span data-stu-id="f1410-172">This allows multiple providers to be registered and used in a single application.</span></span> <span data-ttu-id="f1410-173">Niezmienna nazwa używana w przypadku rejestracji programu EF jest taka sama jak nazwa niezmienna, używana dla ciągów połączenia i Rejestracja dostawcy ADO.NET.</span><span class="sxs-lookup"><span data-stu-id="f1410-173">The invariant name used for EF registrations is the same as the invariant name used for ADO.NET provider registration and connection strings.</span></span> <span data-ttu-id="f1410-174">Na przykład dla programu SQL Server niezmiennej nazwie "System.Data.SqlClient" jest używany.</span><span class="sxs-lookup"><span data-stu-id="f1410-174">For example, for SQL Server the invariant name “System.Data.SqlClient” is used.</span></span>

### <a name="config-file-registration"></a><span data-ttu-id="f1410-175">Rejestracja pliku konfiguracji</span><span class="sxs-lookup"><span data-stu-id="f1410-175">Config file registration</span></span>

<span data-ttu-id="f1410-176">Typ DbProviderServices do użycia jest zarejestrowany jako element dostawcę na liście dostawców entityFramework części pliku konfiguracji aplikacji.</span><span class="sxs-lookup"><span data-stu-id="f1410-176">The DbProviderServices type to use is registered as a provider element in the providers list of the entityFramework section of the application’s config file.</span></span> <span data-ttu-id="f1410-177">Na przykład:</span><span class="sxs-lookup"><span data-stu-id="f1410-177">For example:</span></span>

``` xml
<entityFramework>
  <providers>
    <provider invariantName="My.Invariant.Name" type="MyProvider.MyProviderServices, MyAssembly" />
  </providers>
</entityFramework>
```

<span data-ttu-id="f1410-178">_Typu_ ciąg musi być typu kwalifikowanego zestawu nazwę implementacji DbProviderServices do użycia.</span><span class="sxs-lookup"><span data-stu-id="f1410-178">The _type_ string must be the assembly-qualified type name of the DbProviderServices implementation to use.</span></span>

### <a name="code-based-registration"></a><span data-ttu-id="f1410-179">Oparte na kodzie rejestracji</span><span class="sxs-lookup"><span data-stu-id="f1410-179">Code-based registration</span></span>

<span data-ttu-id="f1410-180">Począwszy od platformy EF6 dostawców można również zarejestrować przy użyciu kodu.</span><span class="sxs-lookup"><span data-stu-id="f1410-180">Starting with EF6 providers can also be registered using code.</span></span> <span data-ttu-id="f1410-181">Dzięki temu dostawcy EF można używać bez zmian do pliku konfiguracji aplikacji.</span><span class="sxs-lookup"><span data-stu-id="f1410-181">This allows an EF provider to be used without any change to the application’s configuration file.</span></span> <span data-ttu-id="f1410-182">Używać konfiguracji oparte na kodzie aplikacji należy utworzyć klasę DbConfiguration, zgodnie z opisem w [dokumentacji oparty na kodzie konfiguracji](https://msdn.com/data/jj680699).</span><span class="sxs-lookup"><span data-stu-id="f1410-182">To use code-based configuration an application should create a DbConfiguration class as described in the [code-based configuration documentation](https://msdn.com/data/jj680699).</span></span> <span data-ttu-id="f1410-183">Konstruktor klasy DbConfiguration następnie należy wywołać SetProviderServices, aby zarejestrować dostawcę EF.</span><span class="sxs-lookup"><span data-stu-id="f1410-183">The constructor of the DbConfiguration class should then call SetProviderServices to register the EF provider.</span></span> <span data-ttu-id="f1410-184">Na przykład:</span><span class="sxs-lookup"><span data-stu-id="f1410-184">For example:</span></span>

``` csharp
public class MyConfiguration : DbConfiguration
{
    public MyConfiguration()
    {
        SetProviderServices("My.New.Provider", new MyProviderServices());
    }
}
```

## <a name="resolving-additional-services"></a><span data-ttu-id="f1410-185">Rozpoznawanie dodatkowych usług</span><span class="sxs-lookup"><span data-stu-id="f1410-185">Resolving additional services</span></span>

<span data-ttu-id="f1410-186">Jak wspomniano powyżej, w _dostawcy typów Przegląd_ sekcji DbProviderServices klasy można również do rozpoznania usług dodatkowych.</span><span class="sxs-lookup"><span data-stu-id="f1410-186">As mentioned above in the _Provider types overview_ section, a DbProviderServices class can also be used to resolve additional services.</span></span> <span data-ttu-id="f1410-187">Jest to możliwe, ponieważ DbProviderServices implementuje IDbDependencyResolver i każdego zarejestrowanego typu DbProviderServices jest dodawany jako "domyślny mechanizm rozwiązywania konfliktów".</span><span class="sxs-lookup"><span data-stu-id="f1410-187">This is possible because DbProviderServices implements IDbDependencyResolver and each registered DbProviderServices type is added as a “default resolver”.</span></span> <span data-ttu-id="f1410-188">Mechanizm IDbDpendencyResolver jest opisany bardziej szczegółowo w [Rozdziale zależności](~/ef6/fundamentals/configuring/dependency-resolution.md).</span><span class="sxs-lookup"><span data-stu-id="f1410-188">The IDbDpendencyResolver mechanism is described in more detail in [Dependency Resolution](~/ef6/fundamentals/configuring/dependency-resolution.md).</span></span> <span data-ttu-id="f1410-189">Jednak nie jest niezbędne zapoznać się z pojęciami w tej specyfikacji do rozpoznania usług dodatkowych, dostawcy.</span><span class="sxs-lookup"><span data-stu-id="f1410-189">However, it is not necessary to understand all the concepts in this specification to resolve additional services in a provider.</span></span>

<span data-ttu-id="f1410-190">Najczęstszym sposobem dostawcy do rozpoznania usług, dodatkowe jest wywołanie DbProviderServices.AddDependencyResolver dla każdej usługi w konstruktorze klasy DbProviderServices.</span><span class="sxs-lookup"><span data-stu-id="f1410-190">The most common way for a provider to resolve additional services is to call DbProviderServices.AddDependencyResolver for each service in the constructor of the DbProviderServices class.</span></span> <span data-ttu-id="f1410-191">Na przykład SqlProviderServices (Dostawca EF dla programu SQL Server) ma kod podobny do tego inicjowania:</span><span class="sxs-lookup"><span data-stu-id="f1410-191">For example, SqlProviderServices (the EF provider for SQL Server) has code similar to this for initialization:</span></span>

``` csharp
private SqlProviderServices()
{
    AddDependencyResolver(new SingletonDependencyResolver<IDbConnectionFactory>(
        new SqlConnectionFactory()));

    AddDependencyResolver(new ExecutionStrategyResolver<DefaultSqlExecutionStrategy>(
        "System.data.SqlClient", null, () => new DefaultSqlExecutionStrategy()));

    AddDependencyResolver(new SingletonDependencyResolver<Func<MigrationSqlGenerator>>(
        () => new SqlServerMigrationSqlGenerator(), "System.data.SqlClient"));

    AddDependencyResolver(new SingletonDependencyResolver<DbSpatialServices>(
        SqlSpatialServices.Instance,
        k =>
        {
            var asSpatialKey = k as DbProviderInfo;
            return asSpatialKey == null
                || asSpatialKey.ProviderInvariantName == ProviderInvariantName;
        }));
}
```

<span data-ttu-id="f1410-192">Ten konstruktor korzysta z następujących klas pomocniczych:</span><span class="sxs-lookup"><span data-stu-id="f1410-192">This constructor uses the following helper classes:</span></span>

*   <span data-ttu-id="f1410-193">SingletonDependencyResolver: zapewnia prosty sposób rozwiązania pojedynczego wystąpienia usług — oznacza to, usług, dla których tego samego wystąpienia jest zwracana zawsze nazywa GetService.</span><span class="sxs-lookup"><span data-stu-id="f1410-193">SingletonDependencyResolver: provides a simple way to resolve Singleton services—that is, services for which the same instance is returned each time that GetService is called.</span></span> <span data-ttu-id="f1410-194">Przejściowy usługi często są rejestrowane jako fabryki singleton, która będzie służyć do tworzenia wystąpienia przejściowego na żądanie.</span><span class="sxs-lookup"><span data-stu-id="f1410-194">Transient services are often registered as a singleton factory that will be used to create transient instances on demand.</span></span>
*   <span data-ttu-id="f1410-195">ExecutionStrategyResolver: program rozpoznawania nazw specyficzne dla zwracania IExecutionStrategy implementacji.</span><span class="sxs-lookup"><span data-stu-id="f1410-195">ExecutionStrategyResolver: a resolver specific to returning IExecutionStrategy implementations.</span></span>

<span data-ttu-id="f1410-196">Zamiast używania DbProviderServices.AddDependencyResolver istnieje również możliwość zastąpienia DbProviderServices.GetService i rozwiązać dodatkowych usług bezpośrednio.</span><span class="sxs-lookup"><span data-stu-id="f1410-196">Instead of using DbProviderServices.AddDependencyResolver it is also possible to override DbProviderServices.GetService and resolve additional services directly.</span></span> <span data-ttu-id="f1410-197">Ta metoda zostanie wywołana, gdy EF potrzebuje usługa definiuje na podstawie określonego typu, a w niektórych przypadkach dla danego klucza.</span><span class="sxs-lookup"><span data-stu-id="f1410-197">This method will be called when EF needs a service defined by a certain type and, in some cases, for a given key.</span></span> <span data-ttu-id="f1410-198">Metoda powinna zwrócić usługi, jeśli można lub zwraca wartość null, jak zrezygnować przekazujących usługi i zezwolić innej klasy go rozwiązać.</span><span class="sxs-lookup"><span data-stu-id="f1410-198">The method should return the service if it can, or return null to opt-out of returning the service and instead allow another class to resolve it.</span></span> <span data-ttu-id="f1410-199">Na przykład aby rozwiązać domyślną fabrykę połączenie kodu w GetService może wyglądać mniej więcej tak:</span><span class="sxs-lookup"><span data-stu-id="f1410-199">For example, to resolve the default connection factory the code in GetService might look something like this:</span></span>

``` csharp
public override object GetService(Type type, object key)
{
    if (type == typeof(IDbConnectionFactory))
    {
        return new SqlConnectionFactory();
    }
    return null;
}
```

### <a name="registration-order"></a><span data-ttu-id="f1410-200">Kolejność rejestracji</span><span class="sxs-lookup"><span data-stu-id="f1410-200">Registration order</span></span>

<span data-ttu-id="f1410-201">Gdy wiele implementacji DbProviderServices są rejestrowane w pliku konfiguracyjnym aplikacji będzie można dodać jako dodatkowej rozpoznawania nazw w kolejności, w jakiej występują na liście.</span><span class="sxs-lookup"><span data-stu-id="f1410-201">When multiple DbProviderServices implementations are registered in an application’s config file they will be added as secondary resolvers in the order that they are listed.</span></span> <span data-ttu-id="f1410-202">Ponieważ rozwiązujący zawsze są dodawane do góry łańcucha dodatkowej programu rozpoznawania nazw, oznacza to, że dostawcy na końcu listy otrzymają Państwo rozpoznać zależności przed innymi.</span><span class="sxs-lookup"><span data-stu-id="f1410-202">Since resolvers are always added to the top of the secondary resolver chain this means that the provider at the end of the list will get a chance to resolve dependencies before the others.</span></span> <span data-ttu-id="f1410-203">(To może wydawać się nieco counter-intuitive na początku, ale dobrym pomysłem Wyobraź sobie, biorąc każdy dostawca z listy i układania na podstawie istniejącego dostawcy).</span><span class="sxs-lookup"><span data-stu-id="f1410-203">(This can seem a little counter-intuitive at first, but it makes sense if you imagine taking each provider out of the list and stacking it on top of the existing providers.)</span></span>

<span data-ttu-id="f1410-204">Zazwyczaj ta kolejność nie ma znaczenia, ponieważ większość usług dostawcy są właściwe dla dostawcy i dostosowane przez nazwa niezmienna dostawcy.</span><span class="sxs-lookup"><span data-stu-id="f1410-204">This ordering usually doesn’t matter because most provider services are provider-specific and keyed by provider invariant name.</span></span> <span data-ttu-id="f1410-205">Jednak dla usług, są nie kluczach nazwa niezmienna dostawcy lub niektórych innych właściwe dla dostawcy klucz, który zostanie rozwiązany usługi oparte na ta kolejność.</span><span class="sxs-lookup"><span data-stu-id="f1410-205">However, for services that are not keyed by provider invariant name or some other provider-specific key the service will be resolved based on this ordering.</span></span> <span data-ttu-id="f1410-206">Na przykład jeśli go nie jest jawnie określona inaczej gdzieś else, domyślna fabryka połączenia będą pochodzić z dostawcę najwyższego poziomu w łańcuchu.</span><span class="sxs-lookup"><span data-stu-id="f1410-206">For example, if it is not explicitly set differently somewhere else, then the default connection factory will come from the topmost provider in the chain.</span></span>

## <a name="additional-config-file-registrations"></a><span data-ttu-id="f1410-207">Rejestracje plików dodatkowych konfiguracji</span><span class="sxs-lookup"><span data-stu-id="f1410-207">Additional config file registrations</span></span>

<span data-ttu-id="f1410-208">Istnieje możliwość jawnie zarejestrować niektórych usług dodatkowego dostawcę opisanych powyżej bezpośrednio w pliku konfiguracji aplikacji.</span><span class="sxs-lookup"><span data-stu-id="f1410-208">It is possible to explicitly register some of the additional provider services described above directly in an application’s config file.</span></span> <span data-ttu-id="f1410-209">Po zakończeniu to rejestrowania w pliku konfiguracji będą używane zamiast niczego zwracany przez metodę GetService implementacji DbProviderServices.</span><span class="sxs-lookup"><span data-stu-id="f1410-209">When this is done the registration in the config file will be used instead of anything returned by the GetService method of the DbProviderServices implementation.</span></span>

### <a name="registering-the-default-connection-factory"></a><span data-ttu-id="f1410-210">Rejestrowanie domyślną fabrykę połączenia</span><span class="sxs-lookup"><span data-stu-id="f1410-210">Registering the default connection factory</span></span>

<span data-ttu-id="f1410-211">Począwszy od EF5 pakiet NuGet platformy EntityFramework automatycznie zarejestrowana fabryka połączenia programu SQL Express lub LocalDb fabryka połączenia w pliku konfiguracji.</span><span class="sxs-lookup"><span data-stu-id="f1410-211">Starting with EF5 the EntityFramework NuGet package automatically registered either the SQL Express connection factory or the LocalDb connection factory in the config file.</span></span>

<span data-ttu-id="f1410-212">Na przykład:</span><span class="sxs-lookup"><span data-stu-id="f1410-212">For example:</span></span>

``` xml
<entityFramework>
  <defaultConnectionFactory type="System.Data.Entity.Infrastructure.SqlConnectionFactory, EntityFramework" >
</entityFramework>
```

<span data-ttu-id="f1410-213">_Typu_ jest nazwą typu kwalifikowanego zestawu usługi fabryka połączenia domyślna musi implementować IDbConnectionFactory.</span><span class="sxs-lookup"><span data-stu-id="f1410-213">The _type_ is the assembly-qualified type name for the default connection factory, which must implement IDbConnectionFactory.</span></span>

<span data-ttu-id="f1410-214">Zalecane jest dostawcy pakietu NuGet ustawienie domyślna fabryka połączenia w ten sposób podczas instalacji.</span><span class="sxs-lookup"><span data-stu-id="f1410-214">It is recommended that a provider NuGet package set the default connection factory in this way when installed.</span></span> <span data-ttu-id="f1410-215">Zobacz _pakietów NuGet dla dostawców_ poniżej.</span><span class="sxs-lookup"><span data-stu-id="f1410-215">See _NuGet Packages for providers_ below.</span></span>

## <a name="additional-ef6-provider-changes"></a><span data-ttu-id="f1410-216">Dodatkowe zmiany dostawcy EF6</span><span class="sxs-lookup"><span data-stu-id="f1410-216">Additional EF6 provider changes</span></span>

### <a name="spatial-provider-changes"></a><span data-ttu-id="f1410-217">Zmiany dostawcy przestrzenne</span><span class="sxs-lookup"><span data-stu-id="f1410-217">Spatial provider changes</span></span>

<span data-ttu-id="f1410-218">Dostawcy, obsługujące typów przestrzennych teraz należy zaimplementować pewne dodatkowe metody na klasy wywodzące się z DbSpatialDataReader:</span><span class="sxs-lookup"><span data-stu-id="f1410-218">Providers that support spatial types must now implement some additional methods on classes deriving from DbSpatialDataReader:</span></span>

*   `public abstract bool IsGeographyColumn(int ordinal)`
*   `public abstract bool IsGeometryColumn(int ordinal)`

<span data-ttu-id="f1410-219">Dostępne są również nowe wersje asynchroniczne istniejących metod, które są zalecane do zastąpienia domyślnej implementacji delegowania do metod synchronicznych i dlatego nie są wykonywane asynchronicznie:</span><span class="sxs-lookup"><span data-stu-id="f1410-219">There are also new asynchronous versions of existing methods that are recommended to be overridden as the default implementations delegate to the synchronous methods and therefore do not execute asynchronously:</span></span>

*   `public virtual Task<DbGeography> GetGeographyAsync(int ordinal, CancellationToken cancellationToken)`
*   `public virtual Task<DbGeometry> GetGeometryAsync(int ordinal, CancellationToken cancellationToken)`

### <a name="native-support-for-enumerablecontains"></a><span data-ttu-id="f1410-220">Natywna obsługa Enumerable.Contains</span><span class="sxs-lookup"><span data-stu-id="f1410-220">Native support for Enumerable.Contains</span></span>

<span data-ttu-id="f1410-221">EF6 wprowadza nowy typ wyrażenia DbInExpression, który został dodany, aby rozwiązać problemy z wydajnością dotyczące użytkowania Enumerable.Contains w kwerendach LINQ.</span><span class="sxs-lookup"><span data-stu-id="f1410-221">EF6 introduces a new expression type, DbInExpression, which was added to address performance issues around use of Enumerable.Contains in LINQ queries.</span></span> <span data-ttu-id="f1410-222">Klasa DbProviderManifest ma nowej metody wirtualnej SupportsInExpression, które jest wywoływane przez EF, aby określić, jeśli dostawca obsługuje nowy typ wyrażenia.</span><span class="sxs-lookup"><span data-stu-id="f1410-222">The DbProviderManifest class has a new virtual method, SupportsInExpression, which is called by EF to determine if a provider handles the new expression type.</span></span> <span data-ttu-id="f1410-223">Dla zachowania zgodności z istniejącej implementacji dostawcy, metoda zwraca wartość false.</span><span class="sxs-lookup"><span data-stu-id="f1410-223">For compatibility with existing provider implementations the method returns false.</span></span> <span data-ttu-id="f1410-224">Aby korzystać z tego ulepszenia, dostawcę EF6 można dodać kod do obsługi DbInExpression i zastąpić SupportsInExpression aby zwracała wartość true.</span><span class="sxs-lookup"><span data-stu-id="f1410-224">To benefit from this improvement, an EF6 provider can add code to handle DbInExpression and override SupportsInExpression to return true.</span></span> <span data-ttu-id="f1410-225">Przez wywołanie metody DbExpressionBuilder.In, można utworzyć wystąpienia elementu DbInExpression.</span><span class="sxs-lookup"><span data-stu-id="f1410-225">An instance of DbInExpression can be created by calling the DbExpressionBuilder.In method.</span></span> <span data-ttu-id="f1410-226">Wystąpienie DbInExpression składa się z DbExpression, zwykle reprezentujący kolumnę tabeli oraz listę DbConstantExpression do testowania pod kątem dopasowania.</span><span class="sxs-lookup"><span data-stu-id="f1410-226">A DbInExpression instance is composed of a DbExpression, usually representing a table column, and a list of DbConstantExpression to test for a match.</span></span>

## <a name="nuget-packages-for-providers"></a><span data-ttu-id="f1410-227">Pakiety NuGet dla dostawców</span><span class="sxs-lookup"><span data-stu-id="f1410-227">NuGet packages for providers</span></span>

<span data-ttu-id="f1410-228">Jednym ze sposobów, aby udostępnić dostawcę EF6 jest zwolnij go jako pakiet NuGet.</span><span class="sxs-lookup"><span data-stu-id="f1410-228">One way to make an EF6 provider available is to release it as a NuGet package.</span></span> <span data-ttu-id="f1410-229">Przy użyciu pakietu NuGet ma następujące zalety:</span><span class="sxs-lookup"><span data-stu-id="f1410-229">Using a NuGet package has the following advantages:</span></span>

*   <span data-ttu-id="f1410-230">Jest łatwa w użyciu pakietu NuGet, aby dodać rejestrację dostawcy do pliku konfiguracji aplikacji</span><span class="sxs-lookup"><span data-stu-id="f1410-230">It is easy to use NuGet to add the provider registration to the application’s config file</span></span>
*   <span data-ttu-id="f1410-231">Dodatkowych zmian do pliku konfiguracji można ustawić domyślną fabrykę połączenia tak, aby nawiązać połączenia przy Konwencji użyje zarejestrowanego dostawcy</span><span class="sxs-lookup"><span data-stu-id="f1410-231">Additional changes can be made to the config file to set the default connection factory so that connections made by convention will use the registered provider</span></span>
*   <span data-ttu-id="f1410-232">NuGet obsługuje dodanie przekierowań powiązań, aby dostawca EF6 będą nadal działać, nawet po opublikowaniu nowego pakietu EF</span><span class="sxs-lookup"><span data-stu-id="f1410-232">NuGet handles adding binding redirects so that the EF6 provider should continue to work even after a new EF package is released</span></span>

<span data-ttu-id="f1410-233">Na przykład to pakiet EntityFramework.SqlServerCompact, który jest dostępny w ["open source" codebase](http://github.com/aspnet/entityframework6).</span><span class="sxs-lookup"><span data-stu-id="f1410-233">An example of this is the EntityFramework.SqlServerCompact package which is included in the [open source codebase](http://github.com/aspnet/entityframework6).</span></span> <span data-ttu-id="f1410-234">Ten pakiet zawiera dobre szablon do tworzenia dostawcy EF pakietów NuGet.</span><span class="sxs-lookup"><span data-stu-id="f1410-234">This package provides a good template for creating EF provider NuGet packages.</span></span>

### <a name="powershell-commands"></a><span data-ttu-id="f1410-235">Polecenia programu PowerShell</span><span class="sxs-lookup"><span data-stu-id="f1410-235">PowerShell commands</span></span>

<span data-ttu-id="f1410-236">Po zainstalowaniu pakietu EntityFramework NuGet rejestruje moduł programu PowerShell, który zawiera dwa polecenia, które są bardzo przydatne w przypadku pakietów dostawcy:</span><span class="sxs-lookup"><span data-stu-id="f1410-236">When the EntityFramework NuGet package is installed it registers a PowerShell module that contains two commands that are very useful for provider packages:</span></span>

*   <span data-ttu-id="f1410-237">Dodaj EFProvider dodaje nową jednostkę dla dostawcy w pliku konfiguracji projektu docelowego i upewnia się, że jest na końcu listę zarejestrowanych dostawców.</span><span class="sxs-lookup"><span data-stu-id="f1410-237">Add-EFProvider adds a new entity for the provider in the target project’s configuration file and makes sure it is at the end of the list of registered providers.</span></span>
*   <span data-ttu-id="f1410-238">Dodaj EFDefaultConnectionFactory dodaje lub aktualizuje rejestracji defaultConnectionFactory w pliku konfiguracji projektu docelowego.</span><span class="sxs-lookup"><span data-stu-id="f1410-238">Add-EFDefaultConnectionFactory either adds or updates the defaultConnectionFactory registration in the target project’s configuration file.</span></span>

<span data-ttu-id="f1410-239">Oba te polecenia zajmie się dodanie sekcji entityFramework do pliku konfiguracji i dodawania kolekcji dostawców, jeśli to konieczne.</span><span class="sxs-lookup"><span data-stu-id="f1410-239">Both these commands take care of adding an entityFramework section to the config file and adding a providers collection if necessary.</span></span>

<span data-ttu-id="f1410-240">Jest ona przeznaczona, że te polecenia można wywołać z install.ps1 skryptu NuGet.</span><span class="sxs-lookup"><span data-stu-id="f1410-240">It is intended that these commands be called from the install.ps1 NuGet script.</span></span> <span data-ttu-id="f1410-241">Na przykład install.ps1 dla dostawcy SQL Compact wygląda podobnie do następującej:</span><span class="sxs-lookup"><span data-stu-id="f1410-241">For example, install.ps1 for the SQL Compact provider looks similar to this:</span></span>

``` powershell
param($installPath, $toolsPath, $package, $project)
Add-EFDefaultConnectionFactory $project 'System.Data.Entity.Infrastructure.SqlCeConnectionFactory, EntityFramework' -ConstructorArguments 'System.Data.SqlServerCe.4.0'
Add-EFProvider $project 'System.Data.SqlServerCe.4.0' 'System.Data.Entity.SqlServerCompact.SqlCeProviderServices, EntityFramework.SqlServerCompact'</pre>
```

<span data-ttu-id="f1410-242">Więcej informacji na temat tych poleceń można uzyskać przy użyciu get-help w oknie Konsola Menedżera pakietów.</span><span class="sxs-lookup"><span data-stu-id="f1410-242">More information about these commands can be obtained by using get-help in the Package Manager Console window.</span></span>

## <a name="wrapping-providers"></a><span data-ttu-id="f1410-243">Zawijanie dostawców</span><span class="sxs-lookup"><span data-stu-id="f1410-243">Wrapping providers</span></span>

<span data-ttu-id="f1410-244">Dostawca zawijania to dostawcy EF i/lub ADO.NET, który otacza istniejącego dostawcy rozszerzać go za pomocą innych funkcje, takie jak profilowania, lub śledzenia możliwości.</span><span class="sxs-lookup"><span data-stu-id="f1410-244">A wrapping provider is an EF and/or ADO.NET provider that wraps an existing provider to extend it with other functionality such as profiling or tracing capabilities.</span></span> <span data-ttu-id="f1410-245">Zawijanie dostawcy mogą być rejestrowane w normalny sposób, ale jest często bardziej wygodne skonfigurować dostawcę zawijania w czasie wykonywania, przechwytuje rozwiązania związane z dostawcą usług.</span><span class="sxs-lookup"><span data-stu-id="f1410-245">Wrapping providers can be registered in the normal way, but it is often more convenient to setup the wrapping provider at runtime by intercepting the resolution of provider-related services.</span></span> <span data-ttu-id="f1410-246">OnLockingConfiguration zdarzeń statycznych w klasie DbConfiguration można to zrobić.</span><span class="sxs-lookup"><span data-stu-id="f1410-246">The static event OnLockingConfiguration on the DbConfiguration class can be used to do this.</span></span>

<span data-ttu-id="f1410-247">OnLockingConfiguration jest wywoływana po EF stwierdził, gdzie otrzymany EF konfiguracji dla domeny aplikacji, ale zanim zostanie zablokowane do użycia.</span><span class="sxs-lookup"><span data-stu-id="f1410-247">OnLockingConfiguration is called after EF has determined where all EF configuration for the app domain will be obtained from but before it is locked for use.</span></span> <span data-ttu-id="f1410-248">Przy uruchamianiu aplikacji (przed użyciem EF) aplikacji należy zarejestrować program obsługi zdarzeń dla tego zdarzenia.</span><span class="sxs-lookup"><span data-stu-id="f1410-248">At app startup (before EF is used) the app should register an event handler for this event.</span></span> <span data-ttu-id="f1410-249">(Są rozważane, dodanie obsługi rejestrowania ten program obsługi w pliku konfiguracji, ale to nie jest jeszcze obsługiwane). Program obsługi zdarzeń powinny następnie wywoływania ReplaceService dla każdej usługi, który ma zostać opakowany.</span><span class="sxs-lookup"><span data-stu-id="f1410-249">(We are considering adding support for registering this handler in the config file but this is not yet supported.) The event handler should then make a call to ReplaceService for every service that needs to be wrapped.</span></span>  

<span data-ttu-id="f1410-250">Na przykład aby zawijać IDbConnectionFactory i DbProviderService, powinny być rejestrowane obsługi podobnie do następującej:</span><span class="sxs-lookup"><span data-stu-id="f1410-250">For example, to wrap IDbConnectionFactory and DbProviderService, a handler something like this should be registered:</span></span>

``` csharp
DbConfiguration.OnLockingConfiguration +=
    (_, a) =>
    {
        a.ReplaceService<DbProviderServices>(
            (s, k) => new MyWrappedProviderServices(s));

        a.ReplaceService<IDbConnectionFactory>(
            (s, k) => new MyWrappedConnectionFactory(s));
    };
```

<span data-ttu-id="f1410-251">Usługa, która został rozwiązany i teraz powinna być otoczona wraz z kluczem, który został użyty do rozwiązania usługi są przekazywane do programu obsługi.</span><span class="sxs-lookup"><span data-stu-id="f1410-251">The service that has been resolved and should now be wrapped together with the key that was used to resolve the service are passed to the handler.</span></span> <span data-ttu-id="f1410-252">Program obsługi można opakować tę usługę i Zastąp zwrócone usługi przy użyciu opakowanej wersji.</span><span class="sxs-lookup"><span data-stu-id="f1410-252">The handler can then wrap this service and replace the returned service with the wrapped version.</span></span>

## <a name="resolving-a-dbproviderfactory-with-ef"></a><span data-ttu-id="f1410-253">Rozpoznawanie DbProviderFactory przy użyciu programu EF</span><span class="sxs-lookup"><span data-stu-id="f1410-253">Resolving a DbProviderFactory with EF</span></span>

<span data-ttu-id="f1410-254">DbProviderFactory jest jednym z typów podstawowych dostawcy wymagane przez EF, zgodnie z opisem w _dostawcy typów Przegląd_ powyższej sekcji.</span><span class="sxs-lookup"><span data-stu-id="f1410-254">DbProviderFactory is one of the fundamental provider types needed by EF as described in the _Provider types overview_ section above.</span></span> <span data-ttu-id="f1410-255">Jak już wspomniano, nie jest typem EF i rejestracji zazwyczaj nie jest częścią konfiguracji EF, ale zamiast tego jest normalne rejestrację dostawcy ADO.NET w pliku machine.config lub pliku konfiguracji aplikacji.</span><span class="sxs-lookup"><span data-stu-id="f1410-255">As already mentioned, It is not an EF type and registration is usually not part of EF configuration, but is instead the normal ADO.NET provider registration in the machine.config file and/or application’s config file.</span></span>

<span data-ttu-id="f1410-256">Pomimo tego EF nadal używa jej mechanizm rozpoznawania zależności normalne podczas wyszukiwania DbProviderFactory do użycia.</span><span class="sxs-lookup"><span data-stu-id="f1410-256">Despite this EF still uses its normal dependency resolution mechanism when looking for a DbProviderFactory to use.</span></span> <span data-ttu-id="f1410-257">Domyślny mechanizm rozwiązywania konfliktów używa normalnej rejestracji ADO.NET w plikach konfiguracji, a więc jest to zazwyczaj niewidoczny.</span><span class="sxs-lookup"><span data-stu-id="f1410-257">The default resolver uses the normal ADO.NET registration in the config files and so this is usually transparent.</span></span> <span data-ttu-id="f1410-258">Jednak ze względu na rozwiązanie normalne zależności jest używany mechanizm oznacza, że IDbDependencyResolver może służyć do rozwiązania DbProviderFactory, nawet wtedy, gdy nie została wykonana normalnej rejestracji ADO.NET.</span><span class="sxs-lookup"><span data-stu-id="f1410-258">But because of the normal dependency resolution mechanism is used it means that an IDbDependencyResolver can be used to resolve a DbProviderFactory even when normal ADO.NET registration has not been done.</span></span>

<span data-ttu-id="f1410-259">Rozpoznawanie DbProviderFactory w ten sposób ma kilka skutki:</span><span class="sxs-lookup"><span data-stu-id="f1410-259">Resolving DbProviderFactory in this way has several implications:</span></span>

*   <span data-ttu-id="f1410-260">Aplikację przy użyciu konfiguracji na podstawie kodu można dodać wywołania w klasie ich DbConfiguration w taki sposób, aby zarejestrować DbProviderFactory odpowiednie.</span><span class="sxs-lookup"><span data-stu-id="f1410-260">An application using code-based configuration can add calls in their DbConfiguration class to register the appropriate DbProviderFactory.</span></span> <span data-ttu-id="f1410-261">Jest to szczególnie przydatne w przypadku aplikacji, które nie mają być (lub nie) należy użyć dowolnej z opartą na plikach konfiguracji na wszystkich.</span><span class="sxs-lookup"><span data-stu-id="f1410-261">This is especially useful for applications that do not want to (or cannot) make use of any file-based configuration at all.</span></span>
*   <span data-ttu-id="f1410-262">Usługa może zostać zawinięty lub zastąpić, korzystając z ReplaceService zgodnie z opisem w _zawijania dostawców_ powyższej sekcji</span><span class="sxs-lookup"><span data-stu-id="f1410-262">The service can be wrapped or replaced using ReplaceService as described in the _Wrapping providers_ section above</span></span>
*   <span data-ttu-id="f1410-263">Teoretycznie implementacji DbProviderServices można rozpoznać DbProviderFactory.</span><span class="sxs-lookup"><span data-stu-id="f1410-263">Theoretically, a DbProviderServices implementation could resolve a DbProviderFactory.</span></span>

<span data-ttu-id="f1410-264">Istotną kwestią należy zwrócić uwagę na sposób żadnej z tych czynności jest, że wpływają one tylko wyszukiwania DbProviderFactory przez EF.</span><span class="sxs-lookup"><span data-stu-id="f1410-264">The important point to note about doing any of these things is that they will only affect the lookup of DbProviderFactory by EF.</span></span> <span data-ttu-id="f1410-265">Inny kod bez EF mogą nadal oczekiwać dostawcy ADO.NET do zarejestrowania się w zwykły sposób i może się nie powieść, jeśli rejestracja nie zostanie znaleziony.</span><span class="sxs-lookup"><span data-stu-id="f1410-265">Other non-EF code may still expect the ADO.NET provider to be registered in the normal way and may fail if the registration is not found.</span></span> <span data-ttu-id="f1410-266">Z tego powodu jest zwykle lepszym miejscem dla DbProviderFactory do zarejestrowania się w zwykły sposób ADO.NET.</span><span class="sxs-lookup"><span data-stu-id="f1410-266">For this reason it is normally better for a DbProviderFactory to be registered in the normal ADO.NET way.</span></span>

### <a name="related-services"></a><span data-ttu-id="f1410-267">Powiązane usługi</span><span class="sxs-lookup"><span data-stu-id="f1410-267">Related services</span></span>

<span data-ttu-id="f1410-268">Jeśli EF jest używany do rozpoznawania DbProviderFactory, również go powinno rozwiązać IProviderInvariantName i IDbProviderFactoryResolver usług.</span><span class="sxs-lookup"><span data-stu-id="f1410-268">If EF is used to resolve a DbProviderFactory, then it should also resolve the IProviderInvariantName and IDbProviderFactoryResolver services.</span></span>

<span data-ttu-id="f1410-269">IProviderInvariantName to usługa, która jest używana do określenia dla danego typu DbProviderFactory nazwę niezmienną dostawcy.</span><span class="sxs-lookup"><span data-stu-id="f1410-269">IProviderInvariantName is a service that is used to determine a provider invariant name for a given type of DbProviderFactory.</span></span> <span data-ttu-id="f1410-270">Domyślna implementacja tej usługi używa rejestracji dostawcy ADO.NET.</span><span class="sxs-lookup"><span data-stu-id="f1410-270">The default implementation of this service uses the ADO.NET provider registration.</span></span> <span data-ttu-id="f1410-271">Oznacza to, że jeśli dostawcy ADO.NET nie jest zarejestrowany w normalny sposób, ponieważ DbProviderFactory jest rozwiązywany za EF, następnie również będzie wymagany do rozwiązania tej usługi.</span><span class="sxs-lookup"><span data-stu-id="f1410-271">This means that if the ADO.NET provider is not registered in the normal way because DbProviderFactory is being resolved by EF, then it will also be necessary to resolve this service.</span></span> <span data-ttu-id="f1410-272">Należy pamiętać, że program rozpoznawania nazw dla tej usługi jest automatycznie dodawane, korzystając z metody DbConfiguration.SetProviderFactory.</span><span class="sxs-lookup"><span data-stu-id="f1410-272">Note that a resolver for this service is automatically added when using the DbConfiguration.SetProviderFactory method.</span></span>

<span data-ttu-id="f1410-273">Zgodnie z opisem w _dostawcy typów Przegląd_ Powyższa sekcja, IDbProviderFactoryResolver jest używany do uzyskiwania poprawne DbProviderFactory z danego obiektu DbConnection.</span><span class="sxs-lookup"><span data-stu-id="f1410-273">As described in the _Provider types overview_ section above, the IDbProviderFactoryResolver is used to obtain the correct DbProviderFactory from a given DbConnection object.</span></span> <span data-ttu-id="f1410-274">Domyślna implementacja tej usługi podczas uruchamiania na .NET 4 używa rejestracji dostawcy ADO.NET.</span><span class="sxs-lookup"><span data-stu-id="f1410-274">The default implementation of this service when running on .NET 4 uses the ADO.NET provider registration.</span></span> <span data-ttu-id="f1410-275">Oznacza to, że jeśli dostawcy ADO.NET nie jest zarejestrowany w normalny sposób, ponieważ DbProviderFactory jest rozwiązywany za EF, następnie również będzie wymagany do rozwiązania tej usługi.</span><span class="sxs-lookup"><span data-stu-id="f1410-275">This means that if the ADO.NET provider is not registered in the normal way because DbProviderFactory is being resolved by EF, then it will also be necessary to resolve this service.</span></span>
